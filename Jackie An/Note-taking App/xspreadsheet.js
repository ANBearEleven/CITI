!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t,e){},function(t,e,n){},function(t,e,n){"use strict";function r(t){return function(t){if(Array.isArray(t))return t}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n.r(e);var o=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),"string"==typeof e?(this.el=document.createElement(e),this.el.className=n):this.el=e,this.data={}}var e,n,o;return e=t,(n=[{key:"data",value:function(t,e){return void 0!==e?(this.data[t]=e,this):this.data[t]}},{key:"on",value:function(t,e){var n=r(t.split(".")),i=n[0],o=n.slice(1),l=i;return"mousewheel"===l&&/Firefox/i.test(window.navigator.userAgent)&&(l="DOMMouseScroll"),this.el.addEventListener(l,function(t){e(t);for(var n=0;n<o.length;n+=1){var r=o[n];if("left"===r&&0!==t.button)return;if("right"===r&&2!==t.button)return;"stop"===r&&t.stopPropagation()}}),this}},{key:"offset",value:function(t){var e=this;if(void 0!==t)return Object.keys(t).forEach(function(n){e.css(n,"".concat(t[n],"px"))}),this;var n=this.el;return{top:n.offsetTop,left:n.offsetLeft,height:n.offsetHeight,width:n.offsetWidth}}},{key:"scroll",value:function(t){var e=this.el;return void 0!==t&&(void 0!==t.left&&(e.scrollLeft=t.left),void 0!==t.top&&(e.scrollTop=t.top)),{left:e.scrollLeft,top:e.scrollTop}}},{key:"box",value:function(){return this.el.getBoundingClientRect()}},{key:"parent",value:function(){return new t(this.el.parentNode)}},{key:"children",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return 0===arguments.length?this.el.childNodes:(n.forEach(function(e){return t.child(e)}),this)}},{key:"child",value:function(e){var n=e;return"string"==typeof e?n=document.createTextNode(e):e instanceof t&&(n=e.el),this.el.appendChild(n),this}},{key:"contains",value:function(t){return this.el.contains(t)}},{key:"className",value:function(t){return void 0!==t?(this.el.className=t,this):this.el.className}},{key:"addClass",value:function(t){return this.el.classList.add(t),this}},{key:"hasClass",value:function(t){return this.el.classList.contains(t)}},{key:"removeClass",value:function(t){return this.el.classList.remove(t),this}},{key:"toggle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"active";return this.toggleClass(t)}},{key:"toggleClass",value:function(t){return this.el.classList.toggle(t)}},{key:"active",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"active";return t?this.addClass(e):this.removeClass(e),this}},{key:"checked",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.active(t,"checked"),this}},{key:"disabled",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return t?this.addClass("disabled"):this.removeClass("disabled"),this}},{key:"attr",value:function(t,e){var n=this;if(void 0!==e)this.el.setAttribute(t,e);else{if("string"==typeof t)return this.el.getAttribute(t);Object.keys(t).forEach(function(e){n.el.setAttribute(e,t[e])})}return this}},{key:"removeAttr",value:function(t){return this.el.removeAttribute(t),this}},{key:"html",value:function(t){return void 0!==t?(this.el.innerHTML=t,this):this.el.innerHTML}},{key:"val",value:function(t){return void 0!==t?(this.el.value=t,this):this.el.value}},{key:"cssRemoveKeys",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.forEach(function(e){return t.el.style.removeProperty(e)}),this}},{key:"css",value:function(t,e){var n=this;return void 0===e&&"string"!=typeof t?(Object.keys(t).forEach(function(e){n.el.style[e]=t[e]}),this):void 0!==e?(this.el.style[t]=e,this):this.el.style[t]}},{key:"computedStyle",value:function(){return window.getComputedStyle(this.el,null)}},{key:"show",value:function(){return this.css("display","block"),this}},{key:"hide",value:function(){return this.css("display","none"),this}}])&&i(e.prototype,n),o&&i(e,o),t}(),l=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new o(t,e)};n(0);function a(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var l,a=t[Symbol.iterator]();!(r=(l=a.next()).done)&&(n.push(l.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var c=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function u(t){for(var e="",n=t;n>=c.length;)n/=c.length,n-=1,e+=c[parseInt(n,10)%c.length];var r=t%c.length;return e+=c[r]}function s(t){for(var e=0,n=0;n<t.length-1;n+=1){var r=t.charCodeAt(n)-65,i=t.length-1-n;e+=Math.pow(c.length,i)+c.length*r}return e+=t.charCodeAt(t.length-1)-65}function f(t){for(var e="",n="",r=0;r<t.length;r+=1)t.charAt(r)>="0"&&t.charAt(r)<="9"?n+=t.charAt(r):e+=t.charAt(r);return[s(e),parseInt(n,10)-1]}function h(t,e){return"".concat(u(t)).concat(e+1)}function p(t,e,n){var r=a(f(t),2);return h(r[0]+e,r[1]+n)}function y(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var l,a=t[Symbol.iterator]();!(r=(l=a.next()).done)&&(n.push(l.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var v=function(){function t(e,n,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sri=e,this.sci=n,this.eri=r,this.eci=i,this.w=o,this.h=l}var e,n,r;return e=t,r=[{key:"valueOf",value:function(e){var n=e.split(":"),r=y(f(n[0]),2),i=r[0],o=r[1],l=o,a=i;if(n.length>1){var c=y(f(n[1]),2);a=c[0],l=c[1]}return new t(o,i,l,a)}}],(n=[{key:"set",value:function(t,e,n,r){this.sri=t,this.sci=e,this.eri=n,this.eci=r}},{key:"multiple",value:function(){return this.eri-this.sri>0||this.eci-this.sci>0}},{key:"includes",value:function(){for(var t=0,e=0,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];if(1===r.length){var o=f(r[0]),l=y(o,2);e=l[0],t=l[1]}else 2===r.length&&(t=r[0],e=r[1]);var a=this.sri,c=this.sci,u=this.eri,s=this.eci;return a<=t&&t<=u&&c<=e&&e<=s}},{key:"each",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},n=this.sri,r=this.sci,i=this.eri,o=this.eci,l=n;l<=i;l+=1)if(e(l))for(var a=r;a<=o;a+=1)t(l,a)}},{key:"contains",value:function(t){return this.sri<=t.sri&&this.sci<=t.sci&&this.eri>=t.eri&&this.eci>=t.eci}},{key:"within",value:function(t){return this.sri>=t.sri&&this.sci>=t.sci&&this.eri<=t.eri&&this.eci<=t.eci}},{key:"disjoint",value:function(t){return this.sri>t.eri||this.sci>t.eci||t.sri>this.eri||t.sci>this.eci}},{key:"intersects",value:function(t){return this.sri<=t.eri&&this.sci<=t.eci&&t.sri<=this.eri&&t.sci<=this.eci}},{key:"union",value:function(e){var n=this.sri,r=this.sci,i=this.eri,o=this.eci;return new t(e.sri<n?e.sri:n,e.sci<r?e.sci:r,e.eri>i?e.eri:i,e.eci>o?e.eci:o)}},{key:"difference",value:function(e){var n=[],r=function(e,r,i,o){n.push(new t(e,r,i,o))},i=this.sri,o=this.sci,l=this.eri,a=this.eci,c=e.sri-i,u=e.sci-o,s=l-e.eri,f=a-e.eci;return c>0?(r(i,o,e.sri-1,a),s>0?(r(e.eri+1,o,l,a),u>0&&r(e.sri,o,e.eri,e.sci-1),f>0&&r(e.sri,e.eci+1,e.eri,a)):(u>0&&r(e.sri,o,l,e.sci-1),f>0&&r(e.sri,e.eci+1,l,a))):s>0&&(r(e.eri+1,o,l,a),u>0&&r(i,o,e.eri,e.sci-1),f>0&&r(i,e.eci+1,e.eri,a)),u>0?(r(i,o,l,e.sci-1),f>0?(r(i,e.eri+1,l,a),c>0&&r(i,e.sci,e.sri-1,e.eci),s>0&&r(e.sri+1,e.sci,l,e.eci)):(c>0&&r(i,e.sci,e.sri-1,a),s>0&&r(e.sri+1,e.sci,l,a))):f>0&&(r(l,e.eci+1,l,a),c>0&&r(i,o,e.sri-1,e.eci),s>0&&r(e.eri+1,o,l,e.eci)),n}},{key:"size",value:function(){return[this.eri-this.sri+1,this.eci-this.sci+1]}},{key:"toString",value:function(){var t=this.sri,e=this.sci,n=this.eri,r=this.eci,i=h(e,t);return this.multiple()&&(i="".concat(i,":").concat(h(r,n))),i}},{key:"clone",value:function(){return new t(this.sri,this.sci,this.eri,this.eci,this.w,this.h)}},{key:"equals",value:function(t){return this.eri===t.eri&&this.eci===t.eci&&this.sri===t.sri&&this.sci===t.sci}}])&&d(e.prototype,n),r&&d(e,r),t}();function b(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var g=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.range=new v(0,0,0,0),this.ri=0,this.ci=0}var e,n,r;return e=t,(n=[{key:"multiple",value:function(){return this.range.multiple()}},{key:"setIndexes",value:function(t,e){this.ri=t,this.ci=e}},{key:"size",value:function(){return this.range.size()}}])&&b(e.prototype,n),r&&b(e,r),t}();var m=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=0,this.y=0,this.ri=0,this.ci=0};function w(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var k=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.undoItems=[],this.redoItems=[]}var e,n,r;return e=t,(n=[{key:"add",value:function(t){this.undoItems.push(JSON.stringify(t)),this.redoItems=[]}},{key:"canUndo",value:function(){return this.undoItems.length>0}},{key:"canRedo",value:function(){return this.redoItems.length>0}},{key:"undo",value:function(t,e){var n=this.undoItems,r=this.redoItems;this.canUndo()&&(r.push(JSON.stringify(t)),e(JSON.parse(n.pop())))}},{key:"redo",value:function(t,e){var n=this.undoItems,r=this.redoItems;this.canRedo()&&(n.push(JSON.stringify(t)),e(JSON.parse(r.pop())))}}])&&w(e.prototype,n),r&&w(e,r),t}();function O(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var S=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.range=null,this.state="clear"}var e,n,r;return e=t,(n=[{key:"copy",value:function(t){return this.range=t,this.state="copy",this}},{key:"cut",value:function(t){return this.range=t,this.state="cut",this}},{key:"isCopy",value:function(){return"copy"===this.state}},{key:"isCut",value:function(){return"cut"===this.state}},{key:"isClear",value:function(){return"clear"===this.state}},{key:"clear",value:function(){this.range=null,this.state="clear"}}])&&O(e.prototype,n),r&&O(e,r),t}();function x(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function E(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function j(t,e,n){return e&&E(t.prototype,e),n&&E(t,n),t}var _=function(){function t(e,n,r){x(this,t),this.ci=e,this.operator=n,this.value=r}return j(t,[{key:"set",value:function(t,e){this.operator=t,this.value=e}},{key:"includes",value:function(t){var e=this.operator,n=this.value;return"all"===e||"in"===e&&n.includes(t)}},{key:"vlength",value:function(){var t=this.operator,e=this.value;return"in"===t?e.length:0}},{key:"getData",value:function(){return{ci:this.ci,operator:this.operator,value:this.value}}}]),t}(),C=function(){function t(e,n){x(this,t),this.ci=e,this.order=n}return j(t,[{key:"asc",value:function(){return"asc"===this.order}},{key:"desc",value:function(){return"desc"===this.order}}]),t}(),T=function(){function t(){x(this,t),this.ref=null,this.filters=[],this.sort=null}return j(t,[{key:"setData",value:function(t){var e=t.ref,n=t.filters,r=t.sort;null!=e&&(this.ref=e,this.fitlers=n.map(function(t){return new _(t.ci,t.operator,t.value)}),r&&(this.sort=new C(r.ci,r.order)))}},{key:"getData",value:function(){if(this.active()){var t=this.ref,e=this.filters,n=this.sort;return{ref:t,filters:e.map(function(t){return t.getData()}),sort:n}}return{}}},{key:"addFilter",value:function(t,e,n){var r=this.getFilter(t);null==r?this.filters.push(new _(t,e,n)):r.set(e,n)}},{key:"setSort",value:function(t,e){this.sort=e?new C(t,e):null}},{key:"includes",value:function(t,e){return!!this.active()&&this.hrange().includes(t,e)}},{key:"getSort",value:function(t){var e=this.sort;return e&&e.ci===t?e:null}},{key:"getFilter",value:function(t){for(var e=this.filters,n=0;n<e.length;n+=1)if(e[n].ci===t)return e[n];return null}},{key:"filteredRows",value:function(t){var e=new Set,n=new Set;if(this.active())for(var r=this.range(),i=r.sri,o=r.eri,l=this.filters,a=i+1;a<=o;a+=1)for(var c=0;c<l.length;c+=1){var u=l[c],s=t(a,u.ci),f=s?s.text:"";if(!u.includes(f)){e.add(a);break}n.add(a)}return{rset:e,fset:n}}},{key:"items",value:function(t,e){var n={};if(this.active())for(var r=this.range(),i=r.sri,o=r.eri,l=i+1;l<=o;l+=1){var a=e(l,t);if(null===a||/^\s*$/.test(a.text))n[""]=(n[""]||0)+1;else{var c=a.text,u=(n[c]||0)+1;n[c]=u}}return n}},{key:"range",value:function(){return v.valueOf(this.ref)}},{key:"hrange",value:function(){var t=this.range();return t.eri=t.sri,t}},{key:"clear",value:function(){this.ref=null,this.filters=[],this.sort=null}},{key:"active",value:function(){return null!==this.ref}}]),t}();function P(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var A=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._=e}var e,n,r;return e=t,(n=[{key:"forEach",value:function(t){this._.forEach(t)}},{key:"deleteWithin",value:function(t){this._=this._.filter(function(e){return!e.within(t)})}},{key:"getFirstIncludes",value:function(t,e){for(var n=0;n<this._.length;n+=1){var r=this._[n];if(r.includes(t,e))return r}return null}},{key:"filterIntersects",value:function(e){return new t(this._.filter(function(t){return t.intersects(e)}))}},{key:"intersects",value:function(t){for(var e=0;e<this._.length;e+=1){if(this._[e].intersects(t))return!0}return!1}},{key:"union",value:function(t){var e=t;return this._.forEach(function(t){t.intersects(e)&&(e=t.union(e))}),e}},{key:"add",value:function(t){this.deleteWithin(t),this._.push(t)}},{key:"shift",value:function(t,e,n,r){this._.forEach(function(i){var o=i.sri,l=i.sci,a=i.eri,c=i.eci,u=i;"row"===t?o>=e?(u.sri+=n,u.eri+=n):o<e&&e<=a&&(u.eri+=n,r(o,l,n,0)):"column"===t&&(l>=e?(u.sci+=n,u.eci+=n):l<e&&e<=c&&(u.eci+=n,r(o,l,0,n)))})}},{key:"move",value:function(t,e,n){this._.forEach(function(r){var i=r;i.within(t)&&(i.eri+=e,i.sri+=e,i.sci+=n,i.eci+=n)})}},{key:"setData",value:function(t){return this._=t.map(function(t){return v.valueOf(t)}),this}},{key:"getData",value:function(){return this._.map(function(t){return t.toString()})}}])&&P(e.prototype,n),r&&P(e,r),t}();var R=function t(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.forEach(function(n){Object.keys(n).forEach(function(r){var i=n[r];"string"==typeof i||"number"==typeof i||"boolean"==typeof i?e[r]=i:"function"!=typeof i&&!Array.isArray(i)&&i instanceof Object?(e[r]=e[r]||{},t(e[r],i)):e[r]=i})}),e};var D={cloneDeep:function(t){return JSON.parse(JSON.stringify(t))},merge:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return R.apply(void 0,[{}].concat(e))},equals:function t(e,n){var r=Object.keys(e);if(r.length!==Object.keys(n).length)return!1;for(var i=0;i<r.length;i+=1){var o=r[i],l=e[o],a=n[o];if(void 0===a)return!1;if("string"==typeof l||"number"==typeof l||"boolean"==typeof l){if(l!==a)return!1}else if(Array.isArray(l)){if(l.length!==a.length)return!1;for(var c=0;c<l.length;c+=1)if(!t(l[c],a[c]))return!1}else if("function"!=typeof l&&!Array.isArray(l)&&l instanceof Object&&!t(l,a))return!1}return!0},arrayEquals:function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n+=1)if(t[n]!==e[n])return!1;return!0},sum:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t},n=0,r=0;return Object.keys(t).forEach(function(i){n+=e(t[i],i),r+=1}),[n,r]},rangeEach:function(t,e,n){for(var r=t;r<e;r+=1)n(r)},rangeSum:function(t,e,n){for(var r=0,i=t;i<e;i+=1)r+=n(i);return r},rangeReduceIf:function(t,e,n,r,i,o){for(var l=n,a=r,c=t;c<e&&!(l>i);c+=1)l+=a=o(c);return[c,l-a,a]},deleteProperty:function(t,e){var n=t["".concat(e)];return delete t["".concat(e)],n}};function z(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var l,a=t[Symbol.iterator]();!(r=(l=a.next()).done)&&(n.push(l.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function I(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var W=function(){function t(e){var n=e.len,r=e.height;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._={},this.len=n,this.height=r}var e,n,r;return e=t,(n=[{key:"getHeight",value:function(t){var e=this.get(t);return e&&e.height?e.height:this.height}},{key:"setHeight",value:function(t,e){this.getOrNew(t).height=e}},{key:"setStyle",value:function(t,e){this.getOrNew(t).style=e}},{key:"sumHeight",value:function(t,e,n){var r=this;return D.rangeSum(t,e,function(t){return n&&n.has(t)?0:r.getHeight(t)})}},{key:"totalHeight",value:function(){return this.sumHeight(0,this.len)}},{key:"get",value:function(t){return this._[t]}},{key:"getOrNew",value:function(t){return this._[t]=this._[t]||{cells:{}},this._[t]}},{key:"getCell",value:function(t,e){var n=this.get(t);return void 0!==n&&void 0!==n.cells&&void 0!==n.cells[e]?n.cells[e]:null}},{key:"getCellMerge",value:function(t,e){var n=this.getCell(t,e);return n&&n.merge?n.merge:[0,0]}},{key:"getCellOrNew",value:function(t,e){var n=this.getOrNew(t);return n.cells[e]=n.cells[e]||{},n.cells[e]}},{key:"setCell",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"all",i=this.getOrNew(t);"all"===r?i.cells[e]=n:"text"===r?(i.cells[e]=i.cells[e]||{},i.cells[e].text=n.text):"format"===r&&(i.cells[e]=i.cells[e]||{},i.cells[e].style=n.style,n.merge&&(i.cells[e].merge=n.merge))}},{key:"setCellText",value:function(t,e,n){this.getCellOrNew(t,e).text=n}},{key:"copyPaste",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},o=t.sri,l=t.sci,a=t.eri,c=t.eci,u=e.sri,s=e.sci,f=e.eri,h=e.eci,y=t.size(),d=z(y,2),v=d[0],b=d[1],g=e.size(),m=z(g,2),w=m[0],k=m[1],O=!0,S=0;(f<o||h<l)&&(O=!1,S=f<o?w:k);for(var x=o;x<=a;x+=1)if(this._[x])for(var E=l;E<=c;E+=1)if(this._[x].cells&&this._[x].cells[E])for(var j=u;j<=f;j+=v)for(var _=s;_<=h;_+=b){var C=j+(x-o),T=_+(E-l),P=D.cloneDeep(this._[x].cells[E]);r&&P&&P.text&&P.text.length>0&&function(){var t=P.text,e=_-s+(j-u)+2;if(O||(e-=S+1),"="===t[0])P.text=t.replace(/\w{1,3}\d/g,function(t){var n=0,r=0;return o===u?n=e-1:r=e-1,p(t,n,r)});else{var n=/[\\.\d]+$/.exec(t);if(null!==n){var r=Number(n[0])+e-1;P.text=t.substring(0,n.index)+r}}}(),this.setCell(C,T,P,n),i(C,T,P)}}},{key:"cutPaste",value:function(t,e){var n=this,r={};this.each(function(i){n.eachCells(i,function(o){var l=parseInt(i,10),a=parseInt(o,10);t.includes(i,o)&&(l=e.sri+(l-t.sri),a=e.sci+(a-t.sci)),r[l]=r[l]||{cells:{}},r[l].cells[a]=n._[i].cells[o]})}),this._=r}},{key:"insert",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n={};this.each(function(r,i){var o=parseInt(r,10);o>=t&&(o+=e),n[o]=i}),this._=n,this.len+=e}},{key:"delete",value:function(t,e){var n=e-t+1,r={};this.each(function(i,o){var l=parseInt(i,10);l<t?r[l]=o:i>e&&(r[l-n]=o)}),this._=r,this.len-=n}},{key:"insertColumn",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.each(function(r,i){var o={};e.eachCells(r,function(e,r){var i=parseInt(e,10);i>=t&&(i+=n),o[i]=r}),i.cells=o})}},{key:"deleteColumn",value:function(t,e){var n=this,r=e-t+1;this.each(function(i,o){var l={};n.eachCells(i,function(n,i){var o=parseInt(n,10);o<t?l[o]=i:o>e&&(l[o-r]=i)}),o.cells=l})}},{key:"deleteCells",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";t.each(function(t,r){e.deleteCell(t,r,n)})}},{key:"deleteCell",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all",r=this.get(t);if(null!==r){var i=this.getCell(t,e);null!==i&&("all"===n?delete r.cells[e]:"text"===n?(i.text&&delete i.text,i.value&&delete i.value):"format"===n?(void 0!==i.style&&delete i.style,i.merge&&delete i.merge):"merge"===n&&i.merge&&delete i.merge)}}},{key:"each",value:function(t){Object.entries(this._).forEach(function(e){var n=z(e,2),r=n[0],i=n[1];t(r,i)})}},{key:"eachCells",value:function(t,e){this._[t]&&this._[t].cells&&Object.entries(this._[t].cells).forEach(function(t){var n=z(t,2),r=n[0],i=n[1];e(r,i)})}},{key:"setData",value:function(t){t.len&&(this.len=t.len,delete t.len),this._=t}},{key:"getData",value:function(){var t=this.len;return Object.assign({len:t},this._)}}])&&I(e.prototype,n),r&&I(e,r),t}();function M(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var F=function(){function t(e){var n=e.len,r=e.width,i=e.indexWidth,o=e.minWidth;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._={},this.len=n,this.width=r,this.indexWidth=i,this.minWidth=o}var e,n,r;return e=t,(n=[{key:"setData",value:function(t){t.len&&(this.len=t.len,delete t.len),this._=t}},{key:"getData",value:function(){var t=this.len;return Object.assign({len:t},this._)}},{key:"getWidth",value:function(t){var e=this._[t];return e&&e.width?e.width:this.width}},{key:"getOrNew",value:function(t){return this._[t]=this._[t]||{},this._[t]}},{key:"setWidth",value:function(t,e){this.getOrNew(t).width=e}},{key:"setStyle",value:function(t,e){this.getOrNew(t).style=e}},{key:"sumWidth",value:function(t,e){var n=this;return D.rangeSum(t,e,function(t){return n.getWidth(t)})}},{key:"totalWidth",value:function(){return this.sumWidth(0,this.len)}}])&&M(e.prototype,n),r&&M(e,r),t}(),N="en",H={en:{toolbar:{undo:"Undo",redo:"Redo",print:"Print",paintformat:"Paint format",clearformat:"Clear format",format:"Format",fontName:"Font",fontSize:"Font size",fontBold:"Font bold",fontItalic:"Font italic",underline:"Underline",strike:"Strike",color:"Text color",bgcolor:"Fill color",border:"Borders",merge:"Merge cells",align:"Horizontal align",valign:"Vertical align",textwrap:"Text wrapping",freeze:"Freeze cell",autofilter:"Filter",formula:"Functions",more:"More"},contextmenu:{copy:"Copy",cut:"Cut",paste:"Paste",pasteValue:"Paste values only",pasteFormat:"Paste format only",insertRow:"Insert row",insertColumn:"Insert column",deleteRow:"Delete row",deleteColumn:"Delete column",deleteCell:"Delete cell",deleteCellText:"Delete cell text",validation:"Data validations",cellprintable:"Enable export",cellnonprintable:"Disable export",celleditable:"Enable editing",cellnoneditable:"Disable editing"},format:{normal:"Normal",text:"Plain Text",number:"Number",percent:"Percent",rmb:"RMB",usd:"USD",eur:"EUR",date:"Date",time:"Time",datetime:"Date time",duration:"Duration"},formula:{sum:"Sum",average:"Average",max:"Max",min:"Min",_if:"IF",and:"AND",or:"OR",concat:"Concat"},validation:{required:"it must be required",notMatch:"it not match its validation rule",between:"it is between {} and {}",notBetween:"it is not between {} and {}",notIn:"it is not in list",equal:"it equal to {}",notEqual:"it not equal to {}",lessThan:"it less than {}",lessThanEqual:"it less than or equal to {}",greaterThan:"it greater than {}",greaterThanEqual:"it greater than or equal to {}"},error:{pasteForMergedCell:"Unable to do this for merged cells"},calendar:{weeks:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"]},button:{cancel:"Cancel",remove:"Remove",save:"Save",ok:"OK"},sort:{desc:"Sort Z -> A",asc:"Sort A -> Z"},filter:{empty:"empty"},dataValidation:{mode:"Mode",range:"Cell Range",criteria:"Criteria",modeType:{cell:"Cell",column:"Colun",row:"Row"},type:{list:"List",number:"Number",date:"Date",phone:"Phone",email:"Email"},operator:{be:"between",nbe:"not betwwen",lt:"less than",lte:"less than or equal to",gt:"greater than",gte:"greater than or equal to",eq:"equal to",neq:"not equal to"}}}};function V(t,e){if(e&&e[N])for(var n=e[N],r=t.split("."),i=0;i<r.length;i+=1){var o=n[r[i]];if(i===r.length-1)return o;if(!o)return;n=o}}function L(t){var e=V(t,H);return!e&&window&&window.x&&window.x.spreadsheet&&window.x.spreadsheet.$messages&&(e=V(t,window.x.spreadsheet.$messages)),e||""}function q(t){return function(){return L(t)}}function B(t,e){N=t,e&&(H[t]=e)}function U(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var l,a=t[Symbol.iterator]();!(r=(l=a.next()).done)&&(n.push(l.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var $={phone:/^[1-9]\d{10}$/,email:/w+([-+.]w+)*@w+([-.]w+)*.w+([-.]w+)*/};function X(t,e){var n="";if(!t){for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];n=L.apply(void 0,["validation.".concat(e)].concat(i))}return[t,n]}var K=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.required=n,this.value=r,this.type=e,this.operator=i,this.message=""}var e,n,r;return e=t,(n=[{key:"parseValue",value:function(t){var e=this.type;return"date"===e?new Date(t):"number"===e?Number(t):t}},{key:"equals",value:function(t){var e=this.type===t.type&&this.required===t.required&&this.operator===t.operator;return e&&(e=Array.isArray(this.value)?D.arrayEquals(this.value,t.value):this.value===t.value),e}},{key:"values",value:function(){return this.value.split(",")}},{key:"validate",value:function(t){var e=this.required,n=this.operator,r=this.value,i=this.type;if(e&&/^\s*$/.test(t))return X(!1,"required");if(/^\s*$/.test(t))return[!0];if($[i]&&!$[i].test(t))return X(!1,"notMatch");if("list"===i)return X(this.values().includes(t),"notIn");if(n){var o=this.parseValue(t);if("be"===n){var l=U(r,2),a=l[0],c=l[1];return X(o>=this.parseValue(a)&&o<=this.parseValue(c),"between",a,c)}if("nbe"===n){var u=U(r,2),s=u[0],f=u[1];return X(o<this.parseValue(s)||o>this.parseValue(f),"notBetween",s,f)}if("eq"===n)return X(o===this.parseValue(r),"equal",r);if("neq"===n)return X(o!==this.parseValue(r),"notEqual",r);if("lt"===n)return X(o<this.parseValue(r),"lessThan",r);if("lte"===n)return X(o<=this.parseValue(r),"lessThanEqual",r);if("gt"===n)return X(o>this.parseValue(r),"greaterThan",r);if("gte"===n)return X(o>=this.parseValue(r),"greaterThanEqual",r)}return[!0]}}])&&Y(e.prototype,n),r&&Y(e,r),t}();function J(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var l,a=t[Symbol.iterator]();!(r=(l=a.next()).done)&&(n.push(l.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Z(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function G(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Q(t,e,n){return e&&G(t.prototype,e),n&&G(t,n),t}var tt=function(){function t(e,n,r){Z(this,t),this.refs=n,this.mode=e,this.validator=r}return Q(t,[{key:"includes",value:function(t,e){for(var n=this.refs,r=0;r<n.length;r+=1){if(v.valueOf(n[r]).includes(t,e))return!0}return!1}},{key:"addRef",value:function(t){this.remove(v.valueOf(t)),this.refs.push(t)}},{key:"remove",value:function(t){var e=[];this.refs.forEach(function(n){var r=v.valueOf(n);r.intersects(t)?r.difference(t).forEach(function(t){return e.push(t.toString())}):e.push(n)}),this.refs=e}},{key:"getData",value:function(){var t=this.refs,e=this.mode,n=this.validator;return{refs:t,mode:e,type:n.type,required:n.required,operator:n.operator,value:n.value}}}],[{key:"valueOf",value:function(e){var n=e.refs,r=e.mode,i=e.type,o=e.required,l=e.operator,a=e.value;return new t(r,n,new K(i,o,a,l))}}]),t}(),et=function(){function t(){Z(this,t),this._=[],this.errors=new Map}return Q(t,[{key:"getError",value:function(t,e){return this.errors.get("".concat(t,"_").concat(e))}},{key:"validate",value:function(t,e,n){var r=this.get(t,e),i="".concat(t,"_").concat(e),o=this.errors;if(null!==r){var l=J(r.validator.validate(n),2),a=l[0],c=l[1];a?o.delete(i):o.set(i,c)}else o.delete(i);return!0}},{key:"add",value:function(t,e,n){var r=n.type,i=n.required,o=n.value,l=n.operator,a=new K(r,i,o,l),c=this.getByValidator(a);null!==c?c.addRef(e):this._.push(new tt(t,[e],a))}},{key:"getByValidator",value:function(t){for(var e=0;e<this._.length;e+=1){var n=this._[e];if(n.validator.equals(t))return n}return null}},{key:"get",value:function(t,e){for(var n=0;n<this._.length;n+=1){var r=this._[n];if(r.includes(t,e))return r}return null}},{key:"remove",value:function(t){this.each(function(e){e.remove(t)})}},{key:"each",value:function(t){this._.forEach(function(e){return t(e)})}},{key:"getData",value:function(){return this._.filter(function(t){return t.refs.length>0}).map(function(t){return t.getData()})}},{key:"setData",value:function(t){this._=t.map(function(t){return tt.valueOf(t)})}}]),t}();function nt(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function rt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function it(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var l,a=t[Symbol.iterator]();!(r=(l=a.next()).done)&&(n.push(l.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var ot={view:{height:function(){return document.documentElement.clientHeight},width:function(){return document.documentElement.clientWidth}},showGrid:!0,showToolbar:!0,showContextmenu:!0,row:{len:100,height:25},col:{len:26,width:100,indexWidth:60,minWidth:60},style:{bgcolor:"#ffffff",align:"left",valign:"middle",textwrap:!1,strike:!1,underline:!1,color:"#0a0a0a",font:{name:"Arial",size:10,bold:!1,italic:!1}}};function lt(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},r=this.merges,i=e.clone(),o=it(t.size(),2),l=o[0],a=o[1],c=it(e.size(),2),u=c[0],s=c[1];return l>u&&(i.eri=e.sri+l-1),a>s&&(i.eci=e.sci+a-1),!r.intersects(i)||(n(L("error.pasteForMergedCell")),!1)}function at(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.rows,o=this.merges;"all"!==n&&"format"!==n||(i.deleteCells(e,n),o.deleteWithin(e)),i.copyPaste(t,e,n,r,function(t,e,n){if(n&&n.merge){var r=it(n.merge,2),i=r[0],l=r[1];if(i<=0&&l<=0)return;o.add(new v(t,e,t+i,e+l))}})}function ct(t,e){var n=this.clipboard,r=this.rows,i=this.merges;r.cutPaste(t,e),i.move(t,e.sri-t.sri,e.sci-t.sci),n.clear()}function ut(t,e,n){var r=this.styles,i=this.rows.getCellOrNew(t,e),o={};void 0!==i.style&&(o=D.cloneDeep(r[i.style])),Object.assign(o,{border:n}),i.style=this.addStyle(o)}var st=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.settings=D.merge(ot,n||{}),this.name=e||"sheet",this.freeze=[0,0],this.styles=[],this.merges=new A,this.rows=new W(this.settings.row),this.cols=new F(this.settings.col),this.validations=new et,this.hyperlinks={},this.comments={},this.selector=new g,this.scroll=new m,this.history=new k,this.clipboard=new S,this.autoFilter=new T,this.change=function(){},this.exceptRowSet=new Set,this.sortedRowMap=new Map,this.unsortedRowMap=new Map}var e,n,r;return e=t,(n=[{key:"addValidation",value:function(t,e,n){var r=this;this.changeData(function(){r.validations.add(t,e,n)})}},{key:"removeValidation",value:function(){var t=this,e=this.selector.range;this.changeData(function(){t.validations.remove(e)})}},{key:"getSelectedValidator",value:function(){var t=this.selector,e=t.ri,n=t.ci,r=this.validations.get(e,n);return r?r.validator:null}},{key:"getSelectedValidation",value:function(){var t=this.selector,e=t.ri,n=t.ci,r=t.range,i=this.validations.get(e,n),o={ref:r.toString()};return null!==i&&(o.mode=i.mode,o.validator=i.validator),o}},{key:"canUndo",value:function(){return this.history.canUndo()}},{key:"canRedo",value:function(){return this.history.canRedo()}},{key:"undo",value:function(){var t=this;this.history.undo(this.getData(),function(e){t.setData(e)})}},{key:"redo",value:function(){var t=this;this.history.redo(this.getData(),function(e){t.setData(e)})}},{key:"copy",value:function(){this.clipboard.copy(this.selector.range)}},{key:"cut",value:function(){this.clipboard.cut(this.selector.range)}},{key:"paste",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=this.clipboard,i=this.selector;return!r.isClear()&&(!!lt.call(this,r.range,i.range,n)&&(this.changeData(function(){r.isCopy()?at.call(t,r.range,i.range,e):r.isCut()&&ct.call(t,r.range,i.range)}),!0))}},{key:"autofill",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=this.selector.range;return!!lt.call(this,i,t,r)&&(this.changeData(function(){at.call(n,i,t,e,!0)}),!0)}},{key:"clearClipboard",value:function(){this.clipboard.clear()}},{key:"calSelectedRangeByEnd",value:function(t,e){var n=this.selector,r=this.rows,i=this.cols,o=this.merges,l=n.range,a=l.sri,c=l.sci,u=l.eri,s=l.eci,f=n.ri,h=n.ci,p=t,y=e;return t<0&&(p=r.len-1),e<0&&(y=i.len-1),p>f?(a=f,u=p):(a=p,u=f),y>h?(c=h,s=y):(c=y,s=h),n.range=o.union(new v(a,c,u,s)),n.range=o.union(n.range),n.range}},{key:"calSelectedRangeByStart",value:function(t,e){var n=this.selector,r=this.rows,i=this.cols,o=this.merges.getFirstIncludes(t,e);return null===o&&(o=new v(t,e,t,e),-1===t&&(o.sri=0,o.eri=r.len-1),-1===e&&(o.sci=0,o.eci=i.len-1)),n.range=o,o}},{key:"setSelectedCellAttr",value:function(t,e){var n=this;this.changeData(function(){var r=n.selector,i=n.styles,o=n.rows;if("merge"===t)e?n.merge():n.unmerge();else if("border"===t)(function(t){var e=this,n=t.mode,r=t.style,i=t.color,o=this.styles,l=this.selector,a=this.rows,c=l.range,u=c.sri,s=c.sci,f=c.eri,h=c.eci,p=!this.isSignleSelected();if(p||"inside"!==n&&"horizontal"!==n&&"vertical"!==n)if("outside"!==n||p){if("none"===n)l.range.each(function(t,n){var r=a.getCell(t,n);if(r&&void 0!==r.style){var i=D.cloneDeep(o[r.style]);delete i.border,r.style=e.addStyle(i)}});else if("all"===n||"inside"===n||"outside"===n||"horizontal"===n||"vertical"===n)!function(){for(var t=[],o=u;o<=f;o+=1)for(var l=s;l<=h;l+=1){for(var c=[],y=0;y<t.length;y+=1){var d=it(t[y],4),v=d[0],b=d[1],g=d[2],m=d[3];if(o===v+g+1&&c.push(y),v<=o&&o<=v+g&&l===b){l+=m+1;break}}if(c.forEach(function(e){return t.splice(e,1)}),l>h)break;var w=a.getCell(o,l),k=0,O=0;if(w&&w.merge){var S=it(w.merge,2);k=S[0],O=S[1],t.push([o,l,k,O])}var x=k>0&&o+k===f,E=O>0&&l+O===h,j={};"all"===n?j={bottom:[r,i],top:[r,i],left:[r,i],right:[r,i]}:"inside"===n?(!E&&l<h&&(j.right=[r,i]),!x&&o<f&&(j.bottom=[r,i])):"horizontal"===n?!x&&o<f&&(j.bottom=[r,i]):"vertical"===n?!E&&l<h&&(j.right=[r,i]):"outside"===n&&p&&(u===o&&(j.top=[r,i]),(x||f===o)&&(j.bottom=[r,i]),s===l&&(j.left=[r,i]),(E||h===l)&&(j.right=[r,i])),Object.keys(j).length>0&&ut.call(e,o,l,j),l+=O}}();else if("top"===n||"bottom"===n)for(var y=s;y<=h;y+=1)"top"===n&&(ut.call(this,u,y,{top:[r,i]}),y+=a.getCellMerge(u,y)[1]),"bottom"===n&&(ut.call(this,f,y,{bottom:[r,i]}),y+=a.getCellMerge(f,y)[1]);else if("left"===n||"right"===n)for(var d=u;d<=f;d+=1)"left"===n&&(ut.call(this,d,s,{left:[r,i]}),d+=a.getCellMerge(d,s)[0]),"right"===n&&(ut.call(this,d,h,{right:[r,i]}),d+=a.getCellMerge(d,h)[0])}else ut.call(this,u,s,{top:[r,i],bottom:[r,i],left:[r,i],right:[r,i]})}).call(n,e);else if("formula"===t){var l=r.ri,a=r.ci,c=r.range;if(r.multiple()){var u=it(r.size(),2),s=u[0],f=u[1],p=c.sri,y=c.sci,d=c.eri,v=c.eci;if(s>1)for(var b=y;b<=v;b+=1){o.getCellOrNew(d+1,b).text="=".concat(e,"(").concat(h(b,p),":").concat(h(b,d),")")}else if(f>1){o.getCellOrNew(l,v+1).text="=".concat(e,"(").concat(h(y,l),":").concat(h(v,l),")")}}else{o.getCellOrNew(l,a).text="=".concat(e,"()")}}else r.range.each(function(r,l){var a=o.getCellOrNew(r,l),c={};if(void 0!==a.style&&(c=D.cloneDeep(i[a.style])),"format"===t)c.format=e,a.style=n.addStyle(c);else if("font-bold"===t||"font-italic"===t||"font-name"===t||"font-size"===t){var u={};u[t.split("-")[1]]=e,c.font=Object.assign(c.font||{},u),a.style=n.addStyle(c)}else"strike"!==t&&"textwrap"!==t&&"underline"!==t&&"align"!==t&&"valign"!==t&&"color"!==t&&"bgcolor"!==t||(c[t]=e,a.style=n.addStyle(c))})})}},{key:"setSelectedCellText",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"input",n=this.autoFilter,r=this.selector,i=this.rows,o=r.ri,l=r.ci,a=o;this.unsortedRowMap.has(o)&&(a=this.unsortedRowMap.get(o));var c=i.getCell(a,l),u=c?c.text:"";if(this.setCellText(a,l,t,e),n.active()){var s=n.getFilter(l);if(s){var f=s.value.findIndex(function(t){return t===u});f>=0&&s.value.splice(f,1,t)}}}},{key:"getSelectedCell",value:function(){var t=this.selector,e=t.ri,n=t.ci,r=e;return this.unsortedRowMap.has(e)&&(r=this.unsortedRowMap.get(e)),this.rows.getCell(r,n)}},{key:"xyInSelectedRect",value:function(t,e){var n=this.getSelectedRect(),r=n.left,i=n.top,o=n.width,l=n.height,a=t-this.cols.indexWidth,c=e-this.rows.height;return a>r&&a<r+o&&c>i&&c<i+l}},{key:"getSelectedRect",value:function(){return this.getRect(this.selector.range)}},{key:"getClipboardRect",value:function(){var t=this.clipboard;return t.isClear()?{left:-100,top:-100}:this.getRect(t.range)}},{key:"getRect",value:function(t){var e=this.scroll,n=this.rows,r=this.cols,i=this.exceptRowSet,o=t.sri,l=t.sci,a=t.eri,c=t.eci;if(o<0&&l<0)return{left:0,l:0,top:0,t:0,scroll:e};var u=r.sumWidth(0,l),s=n.sumHeight(0,o,i),f=n.sumHeight(o,a+1,i),h=r.sumWidth(l,c+1),p=u-e.x,y=s-e.y,d=this.freezeTotalHeight(),v=this.freezeTotalWidth();return v>0&&v>u&&(p=u),d>0&&d>s&&(y=s),{l:u,t:s,left:p,top:y,height:f,width:h,scroll:e}}},{key:"getCellRectByXY",value:function(t,e){var n=this.scroll,r=this.merges,i=this.rows,o=this.cols,l=function(t,e){var n=this.rows,r=this.freezeTotalHeight(),i=n.height;r+n.height<t&&(i-=e);for(var o=this.exceptRowSet,l=0,a=i,c=n.height;l<n.len&&!(a>t);l+=1)o.has(l)||(a+=c=n.getHeight(l));return(a-=c)<=0?{ri:-1,top:0,height:c}:{ri:l-1,top:a,height:c}}.call(this,e,n.y),a=l.ri,c=l.top,u=l.height,s=function(t,e){var n=this.cols,r=this.freezeTotalWidth(),i=n.indexWidth;r+n.indexWidth<t&&(i-=e);var o=it(D.rangeReduceIf(0,n.len,i,n.indexWidth,t,function(t){return n.getWidth(t)}),3),l=o[0],a=o[1],c=o[2];return a<=0?{ci:-1,left:0,width:n.indexWidth}:{ci:l-1,left:a,width:c}}.call(this,t,n.x),f=s.ci,h=s.left,p=s.width;if(-1===f&&(p=o.totalWidth()),-1===a&&(u=i.totalHeight()),a>=0||f>=0){var y=r.getFirstIncludes(a,f);if(y){a=y.sri,f=y.sci;var d=this.cellRect(a,f);h=d.left,c=d.top,p=d.width,u=d.height}}return{ri:a,ci:f,left:h,top:c,width:p,height:u}}},{key:"isSignleSelected",value:function(){var t=this.selector.range,e=t.sri,n=t.sci,r=t.eri,i=t.eci,o=this.getCell(e,n);if(o&&o.merge){var l=it(o.merge,2),a=l[0],c=l[1];if(e+a===r&&n+c===i)return!0}return!this.selector.multiple()}},{key:"canUnmerge",value:function(){var t=this.selector.range,e=t.sri,n=t.sci,r=t.eri,i=t.eci,o=this.getCell(e,n);if(o&&o.merge){var l=it(o.merge,2),a=l[0],c=l[1];if(e+a===r&&n+c===i)return!0}return!1}},{key:"merge",value:function(){var t=this,e=this.selector,n=this.rows;if(!this.isSignleSelected()){var r=it(e.size(),2),i=r[0],o=r[1];if(i>1||o>1){var l=e.range,a=l.sri,c=l.sci;this.changeData(function(){var r=n.getCellOrNew(a,c);r.merge=[i-1,o-1],t.merges.add(e.range),t.rows.deleteCells(e.range),t.rows.setCell(a,c,r)})}}}},{key:"unmerge",value:function(){var t=this,e=this.selector;if(this.isSignleSelected()){var n=e.range,r=n.sri,i=n.sci;this.changeData(function(){t.rows.deleteCell(r,i,"merge"),t.merges.deleteWithin(e.range)})}}},{key:"canAutofilter",value:function(){return!this.autoFilter.active()}},{key:"autofilter",value:function(){var t=this,e=this.autoFilter,n=this.selector;this.changeData(function(){e.active()?(e.clear(),t.exceptRowSet=new Set,t.sortedRowMap=new Map,t.unsortedRowMap=new Map):e.ref=n.range.toString()})}},{key:"setAutoFilter",value:function(t,e,n,r){var i=this.autoFilter;i.addFilter(t,n,r),i.setSort(t,e),this.resetAutoFilter()}},{key:"resetAutoFilter",value:function(){var t=this,e=this.autoFilter,n=this.rows;if(e.active()){var r=e.sort,i=e.filteredRows(function(t,e){return n.getCell(t,e)}),o=i.rset,l=i.fset,a=Array.from(l),c=Array.from(l);r&&a.sort(function(t,e){return"asc"===r.order?t-e:"desc"===r.order?e-t:0}),this.exceptRowSet=o,this.sortedRowMap=new Map,this.unsortedRowMap=new Map,a.forEach(function(e,n){t.sortedRowMap.set(c[n],e),t.unsortedRowMap.set(e,c[n])})}}},{key:"deleteCell",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",n=this.selector;this.changeData(function(){t.rows.deleteCells(n.range,e),"all"!==e&&"format"!==e||t.merges.deleteWithin(n.range)})}},{key:"insert",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.changeData(function(){var r=e.selector.range,i=r.sri,o=r.sci,l=e.rows,a=e.merges,c=e.cols,u=i;"row"===t?l.insert(i,n):"column"===t&&(l.insertColumn(o,n),u=o,c.len+=1),a.shift(t,u,n,function(t,e,n,r){var i=l.getCell(t,e);i.merge[0]+=n,i.merge[1]+=r})})}},{key:"delete",value:function(t){var e=this;this.changeData(function(){var n=e.rows,r=e.merges,i=e.selector,o=e.cols,l=i.range,a=i.range,c=a.sri,u=a.sci,s=a.eri,f=a.eci,h=it(i.range.size(),2),p=h[0],y=h[1],d=c,v=p;"row"===t?n.delete(c,s):"column"===t&&(n.deleteColumn(u,f),d=l.sci,v=y,o.len-=1),r.shift(t,d,-v,function(t,e,r,i){var o=n.getCell(t,e);o.merge[0]+=r,o.merge[1]+=i,0===o.merge[0]&&0===o.merge[1]&&delete o.merge})})}},{key:"scrollx",value:function(t,e){var n=this.scroll,r=this.freeze,i=this.cols,o=it(r,2)[1],l=it(D.rangeReduceIf(o,i.len,0,0,t,function(t){return i.getWidth(t)}),3),a=l[0],c=l[1],u=l[2],s=c;t>0&&(s+=u),n.x!==s&&(n.ci=t>0?a:0,n.x=s,e())}},{key:"scrolly",value:function(t,e){var n=this.scroll,r=this.freeze,i=this.rows,o=it(r,1)[0],l=it(D.rangeReduceIf(o,i.len,0,0,t,function(t){return i.getHeight(t)}),3),a=l[0],c=l[1],u=l[2],s=c;t>0&&(s+=u),n.y!==s&&(n.ri=t>0?a:0,n.y=s,e())}},{key:"cellRect",value:function(t,e){var n=this.rows,r=this.cols,i=r.sumWidth(0,e),o=n.sumHeight(0,t),l=n.getCell(t,e),a=r.getWidth(e),c=n.getHeight(t);if(null!==l&&l.merge){var u=it(l.merge,2),s=u[0],f=u[1];if(s>0)for(var h=1;h<=s;h+=1)c+=n.getHeight(t+h);if(f>0)for(var p=1;p<=f;p+=1)a+=r.getWidth(e+p)}return{left:i,top:o,width:a,height:c,cell:l}}},{key:"getCell",value:function(t,e){return this.rows.getCell(t,e)}},{key:"getCellTextOrDefault",value:function(t,e){var n=this.getCell(t,e);return n&&n.text?n.text:""}},{key:"getCellStyle",value:function(t,e){var n=this.getCell(t,e);return n&&void 0!==n.style?this.styles[n.style]:null}},{key:"getCellStyleOrDefault",value:function(t,e){var n=this.styles,r=this.rows.getCell(t,e),i=r&&void 0!==r.style?n[r.style]:{};return D.merge(this.defaultStyle(),i)}},{key:"getSelectedCellStyle",value:function(){var t=this.selector,e=t.ri,n=t.ci;return this.getCellStyleOrDefault(e,n)}},{key:"setCellText",value:function(t,e,n,r){var i=this.rows,o=this.history,l=this.validations;"finished"===r?(i.setCellText(t,e,""),o.add(this.getData()),i.setCellText(t,e,n)):(i.setCellText(t,e,n),this.change(this.getData())),l.validate(t,e,n)}},{key:"freezeIsActive",value:function(){var t=it(this.freeze,2),e=t[0],n=t[1];return e>0||n>0}},{key:"setFreeze",value:function(t,e){var n=this;this.changeData(function(){n.freeze=[t,e]})}},{key:"freezeTotalWidth",value:function(){return this.cols.sumWidth(0,this.freeze[1])}},{key:"freezeTotalHeight",value:function(){return this.rows.sumHeight(0,this.freeze[0])}},{key:"setRowHeight",value:function(t,e){var n=this;this.changeData(function(){n.rows.setHeight(t,e)})}},{key:"setColWidth",value:function(t,e){var n=this;this.changeData(function(){n.cols.setWidth(t,e)})}},{key:"viewHeight",value:function(){var t=this.settings,e=t.view,n=t.showToolbar,r=e.height();return n&&(r-=41),r}},{key:"viewWidth",value:function(){return this.settings.view.width()}},{key:"freezeViewRange",value:function(){var t=it(this.freeze,2),e=t[0],n=t[1];return new v(0,0,e-1,n-1,this.freezeTotalWidth(),this.freezeTotalHeight())}},{key:"exceptRowTotalHeight",value:function(t,e){var n=this.exceptRowSet,r=this.rows,i=Array.from(n),o=0;return i.forEach(function(n){if(n<t||n>e){var i=r.getHeight(n);o+=i}}),o}},{key:"viewRange",value:function(){var t=this.scroll,e=this.rows,n=this.cols,r=this.freeze,i=this.exceptRowSet,o=t.ri,l=t.ci;o<=0&&(o=it(r,1)[0]);l<=0&&(l=it(r,2)[1]);for(var a=0,c=0,u=[e.len,n.len],s=u[0],f=u[1],h=o;h<e.len&&(i.has(h)||(c+=e.getHeight(h),s=h),!(c>this.viewHeight()));h+=1);for(var p=l;p<n.len&&(f=p,!((a+=n.getWidth(p))>this.viewWidth()));p+=1);return new v(o,l,s,f,a,c)}},{key:"eachMergesInView",value:function(t,e){this.merges.filterIntersects(t).forEach(function(t){return e(t)})}},{key:"rowEach",value:function(t,e,n){for(var r=0,i=this.rows,o=this.exceptRowSet,l=nt(o),a=0,c=0;c<l.length;c+=1)l[c]<t&&(a+=1);for(var u=t+a;u<=e+a;u+=1)if(o.has(u))a+=1;else{var s=i.getHeight(u);if(n(u,r,s),(r+=s)>this.viewHeight())break}}},{key:"colEach",value:function(t,e,n){for(var r=0,i=this.cols,o=t;o<=e;o+=1){var l=i.getWidth(o);if(n(o,r,l),(r+=l)>this.viewWidth())break}}},{key:"defaultStyle",value:function(){return this.settings.style}},{key:"addStyle",value:function(t){for(var e=this.styles,n=0;n<e.length;n+=1){var r=e[n];if(D.equals(r,t))return n}return e.push(t),e.length-1}},{key:"changeData",value:function(t){this.history.add(this.getData()),t(),this.change(this.getData())}},{key:"setData",value:function(t){var e=this;return Object.keys(t).forEach(function(n){if("merges"===n||"rows"===n||"cols"===n||"validations"===n)e[n].setData(t[n]);else if("freeze"===n){var r=it(f(t[n]),2),i=r[0],o=r[1];e.freeze=[o,i]}else void 0!==t[n]&&(e[n]=t[n])}),this}},{key:"getData",value:function(){var t=this.name,e=this.freeze,n=this.styles,r=this.merges,i=this.rows,o=this.cols,l=this.validations,a=this.autoFilter;return{name:t,freeze:h(e[1],e[0]),styles:n,merges:r.getData(),rows:i.getData(),cols:o.getData(),validations:l.getData(),autofilter:a.getData()}}}])&&rt(e.prototype,n),r&&rt(e,r),t}();function ft(t,e,n){t.addEventListener(e,n)}function ht(t,e,n){t.removeEventListener(e,n)}function pt(t){t.xclickoutside&&(ht(window.document.body,"click",t.xclickoutside),delete t.xclickoutside)}function yt(t,e){t.xclickoutside=function(n){2===n.detail||t.contains(n.target)||(e?e(t):(t.hide(),pt(t)))},ft(window.document.body,"click",t.xclickoutside)}function dt(t,e,n){ft(t,"mousemove",e),t.xEvtUp=function(r){ht(t,"mousemove",e),ht(t,"mouseup",t.xEvtUp),n(r)},ft(t,"mouseup",t.xEvtUp)}function vt(t,e,n,r){Math.abs(t)>Math.abs(e)?r(t>0?"right":"left",t,n):r(e>0?"down":"up",e,n)}var bt="x-spreadsheet";window.devicePixelRatio;function gt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var mt=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=arguments.length>1?arguments[1]:void 0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.moving=!1,this.vertical=n,this.el=l("div","".concat(bt,"-resizer ").concat(n?"vertical":"horizontal")).children(this.hoverEl=l("div","".concat(bt,"-resizer-hover")).on("mousedown.stop",function(t){return e.mousedownHandler(t)}),this.lineEl=l("div","".concat(bt,"-resizer-line")).hide()).hide(),this.cRect=null,this.finishedFn=null,this.minDistance=r}var e,n,r;return e=t,(n=[{key:"show",value:function(t,e){var n=this.moving,r=this.vertical,i=this.hoverEl,o=this.lineEl,l=this.el;if(!n){this.cRect=t;var a=t.left,c=t.top,u=t.width,s=t.height;l.offset({left:r?a+u-5:a,top:r?c:c+s-5}).show(),i.offset({width:r?5:u,height:r?s:5}),o.offset({width:r?0:e.width,height:r?e.height:0})}}},{key:"hide",value:function(){this.el.offset({left:0,top:0}).hide()}},{key:"mousedownHandler",value:function(t){var e=this,n=t,r=this.el,i=this.lineEl,o=this.cRect,l=this.vertical,a=this.minDistance,c=l?o.width:o.height;i.show(),dt(window,function(t){e.moving=!0,null!==n&&1===t.buttons&&(l?(c+=t.movementX)>a&&r.css("left","".concat(o.left+c,"px")):(c+=t.movementY)>a&&r.css("top","".concat(o.top+c,"px")),n=t)},function(){n=null,i.hide(),e.moving=!1,e.hide(),e.finishedFn&&(c<a&&(c=a),e.finishedFn(o,c))})}}])&&gt(e.prototype,n),r&&gt(e,r),t}();function wt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var kt=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.vertical=e,this.moveFn=null,this.el=l("div","".concat(bt,"-scrollbar ").concat(e?"vertical":"horizontal")).child(this.contentEl=l("div","")).on("mousemove.stop",function(){}).on("scroll.stop",function(t){var e=t.target,r=e.scrollTop,i=e.scrollLeft;n.moveFn&&n.moveFn(n.vertical?r:i,t)})}var e,n,r;return e=t,(n=[{key:"move",value:function(t){return this.el.scroll(t),this}},{key:"scroll",value:function(){return this.el.scroll()}},{key:"set",value:function(t,e){var n=t-1;if(e>n){var r=this.vertical?"height":"width";this.el.css(r,"".concat(n-15,"px")).show(),this.contentEl.css(this.vertical?"width":"height","1px").css(r,"".concat(e,"px"))}else this.el.hide();return this}}])&&wt(e.prototype,n),r&&wt(e,r),t}();function Ot(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function St(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function xt(t,e,n){return e&&St(t.prototype,e),n&&St(t,n),t}var Et=10,jt=function(){function t(){Ot(this,t),this.cornerEl=l("div","".concat(bt,"-selector-corner")),this.areaEl=l("div","".concat(bt,"-selector-area")).child(this.cornerEl).hide(),this.clipboardEl=l("div","".concat(bt,"-selector-clipboard")).hide(),this.autofillEl=l("div","".concat(bt,"-selector-autofill")).hide(),this.el=l("div","".concat(bt,"-selector")).css("z-index","".concat(Et)).children(this.areaEl,this.clipboardEl,this.autofillEl).hide(),Et+=1}return xt(t,[{key:"setOffset",value:function(t){return this.el.offset(t).show(),this}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"setAreaOffset",value:function(t){var e=t.left,n=t.top,r=t.width,i=t.height;this.areaEl.offset({width:r-3+.8,height:i-3+.8,left:e-.8,top:n-.8}).show()}},{key:"setClipboardOffset",value:function(t){var e=t.left,n=t.top,r=t.width,i=t.height;this.clipboardEl.offset({left:e,top:n,width:r-5,height:i-5})}},{key:"showAutofill",value:function(t){var e=t.left,n=t.top,r=t.width,i=t.height;this.autofillEl.offset({width:r-3,height:i-3,left:e,top:n}).show()}},{key:"hideAutofill",value:function(){this.autofillEl.hide()}},{key:"showClipboard",value:function(){this.clipboardEl.show()}},{key:"hideClipboard",value:function(){this.clipboardEl.hide()}}]),t}();function _t(t){var e=this.data,n=t.left,r=t.top,i=t.width,o=t.height,l=t.scroll,a=t.l,c=t.t,u=e.freezeTotalWidth(),s=e.freezeTotalHeight(),f=n-u;u>a&&(f-=l.x);var h=r-s;return s>c&&(h-=l.y),{left:f,top:h,width:i,height:o}}function Ct(t){var e=this.data,n=t.left,r=t.width,i=t.height,o=t.l,l=t.t,a=t.scroll,c=e.freezeTotalWidth(),u=n-c;return c>o&&(u-=a.x),{left:u,top:l,width:r,height:i}}function Tt(t){var e=this.data,n=t.top,r=t.width,i=t.height,o=t.l,l=t.t,a=t.scroll,c=e.freezeTotalHeight(),u=n-c;return c>l&&(u-=a.y),{left:o,top:u,width:r,height:i}}function Pt(t){this.br.setAreaOffset(_t.call(this,t))}function At(t){this.t.setAreaOffset(Ct.call(this,t))}function Rt(t){this.l.setAreaOffset(Tt.call(this,t))}function Dt(t){this.l.setClipboardOffset(Tt.call(this,t))}function zt(t){this.br.setClipboardOffset(_t.call(this,t))}function It(t){this.t.setClipboardOffset(Ct.call(this,t))}function Wt(t){Pt.call(this,t),function(t){this.tl.setAreaOffset(t)}.call(this,t),At.call(this,t),Rt.call(this,t)}function Mt(t){zt.call(this,t),function(t){this.tl.setClipboardOffset(t)}.call(this,t),It.call(this,t),Dt.call(this,t)}var Ft=function(){function t(e){Ot(this,t),this.data=e,this.br=new jt,this.t=new jt,this.l=new jt,this.tl=new jt,this.br.el.show(),this.offset=null,this.areaOffset=null,this.indexes=null,this.range=null,this.arange=null,this.el=l("div","".concat(bt,"-selectors")).children(this.tl.el,this.t.el,this.l.el,this.br.el).hide(),this.lastri=-1,this.lastci=-1,Et+=1}return xt(t,[{key:"hide",value:function(){this.el.hide()}},{key:"resetOffset",value:function(){var t=this.data,e=this.tl,n=this.t,r=this.l,i=this.br,o=t.freezeTotalHeight(),l=t.freezeTotalWidth();o>0||l>0?(e.setOffset({width:l,height:o}),n.setOffset({left:l,height:o}),r.setOffset({top:o,width:l}),i.setOffset({left:l,top:o})):(e.hide(),n.hide(),r.hide(),i.setOffset({left:0,top:0}))}},{key:"resetAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();Wt.call(this,t),Mt.call(this,e),this.resetOffset()}},{key:"resetBRTAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();Pt.call(this,t),At.call(this,t),zt.call(this,e),It.call(this,e),this.resetOffset()}},{key:"resetBRLAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();Pt.call(this,t),Rt.call(this,t),zt.call(this,e),Dt.call(this,e),this.resetOffset()}},{key:"set",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this.data,i=r.calSelectedRangeByStart(t,e),o=i.sri,l=i.sci;if(n){var a=t,c=e;t<0&&(a=0),e<0&&(c=0),r.selector.setIndexes(a,c),this.indexes=[a,c]}this.moveIndexes=[o,l],this.range=i,this.resetAreaOffset(),this.el.show()}},{key:"setEnd",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this.data,i=this.lastri,o=this.lastci;if(n){if(t===i&&e===o)return;this.lastri=t,this.lastci=e}this.range=r.calSelectedRangeByEnd(t,e),Wt.call(this,this.data.getSelectedRect())}},{key:"reset",value:function(){var t=this.data.selector.range,e=t.eri,n=t.eci;this.setEnd(e,n)}},{key:"showAutofill",value:function(t,e){if(-1!==t||-1!==e){var n=this.range,r=n.sri,i=n.sci,o=n.eri,l=n.eci,a=t,c=e,u=r-t,s=o-t,f=l-e;if(i-e>0)this.arange=new v(r,c,o,i-1);else if(u>0)this.arange=new v(a,i,r-1,l);else if(f<0)this.arange=new v(r,l+1,o,c);else{if(!(s<0))return void(this.arange=null);this.arange=new v(o+1,i,a,l)}if(null!==this.arange){var h=this.data.getRect(this.arange);h.width+=2,h.height+=2;var p=this.br,y=this.l,d=this.t,b=this.tl;p.showAutofill(_t.call(this,h)),y.showAutofill(Tt.call(this,h)),d.showAutofill(Ct.call(this,h)),b.showAutofill(h)}}}},{key:"hideAutofill",value:function(){var t=this;["br","l","t","tl"].forEach(function(e){t[e].hideAutofill()})}},{key:"showClipboard",value:function(){var t=this,e=this.data.getClipboardRect();Mt.call(this,e),["br","l","t","tl"].forEach(function(e){t[e].showClipboard()})}},{key:"hideClipboard",value:function(){var t=this;["br","l","t","tl"].forEach(function(e){t[e].hideClipboard()})}}]),t}();function Nt(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Ht(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Vt(t){t.preventDefault();var e=this.filterItems;e.length<=0||(t.stopPropagation(),this.itemIndex<0&&(this.itemIndex=0),e[this.itemIndex].el.click(),this.hide())}var Lt=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"200px";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.filterItems=[],this.items=e,this.el=l("div","".concat(bt,"-suggest")).css("width",r).hide(),this.itemClick=n,this.itemIndex=-1}var e,n,r;return e=t,(n=[{key:"setOffset",value:function(t){this.el.cssRemoveKeys("top","bottom").offset(t)}},{key:"hide",value:function(){var t=this.el;this.filterItems=[],this.itemIndex=-1,t.hide(),pt(this.el.parent())}},{key:"setItems",value:function(t){this.items=t}},{key:"search",value:function(t){var e,n=this,r=this.items;if(/^\s*$/.test(t)||(r=r.filter(function(e){return(e.key||e).startsWith(t.toUpperCase())})),r=r.map(function(t){var e=t.title;e?"function"==typeof e&&(e=e()):e=t;var r=l("div","".concat(bt,"-item")).child(e).on("click.stop",function(){n.itemClick(t),n.hide()});return t.label&&r.child(l("div","label").html(t.label)),r}),this.filterItems=r,!(r.length<=0)){var i=this.el;(e=i.html("")).children.apply(e,Nt(r)).show(),yt(i.parent(),function(){n.hide()})}}},{key:"bindInputEvents",value:function(t){var e=this;t.on("keydown",function(t){return function(t){var e=t.keyCode;switch(t.ctrlKey&&t.stopPropagation(),e){case 37:t.stopPropagation();break;case 38:(function(t){t.preventDefault(),t.stopPropagation();var e=this.filterItems;e.length<=0||(this.itemIndex>=0&&e[this.itemIndex].toggle(),this.itemIndex-=1,this.itemIndex<0&&(this.itemIndex=e.length-1),e[this.itemIndex].toggle())}).call(this,t);break;case 39:t.stopPropagation();break;case 40:(function(t){t.stopPropagation();var e=this.filterItems;e.length<=0||(this.itemIndex>=0&&e[this.itemIndex].toggle(),this.itemIndex+=1,this.itemIndex>e.length-1&&(this.itemIndex=0),e[this.itemIndex].toggle())}).call(this,t);break;case 13:case 9:Vt.call(this,t);break;default:t.stopPropagation()}}.call(e,t)})}}])&&Ht(e.prototype,n),r&&Ht(e,r),t}();function qt(t){return(qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ut(t,e){return!e||"object"!==qt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Yt(t){return(Yt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $t(t,e){return($t=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xt=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Ut(this,Yt(e).call(this,"div","".concat(bt,"-icon")))).iconNameEl=l("div","".concat(bt,"-icon-img ").concat(t)),n.child(n.iconNameEl),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$t(t,e)}(e,o),n=e,(r=[{key:"setName",value:function(t){this.iconNameEl.className("".concat(bt,"-icon-img ").concat(t))}}])&&Bt(n.prototype,r),i&&Bt(n,i),e}();function Kt(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Jt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Zt(t,e){t.setMonth(t.getMonth()+e)}function Gt(t,e){var n=new Date(t);return n.setDate(e-t.getDay()+1),n}var Qt=function(){function t(e){var n,r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.value=e,this.cvalue=new Date(e),this.headerLeftEl=l("div","calendar-header-left"),this.bodyEl=l("tbody",""),this.buildAll(),this.el=l("div","x-spreadsheet-calendar").children(l("div","calendar-header").children(this.headerLeftEl,l("div","calendar-header-right").children(l("a","calendar-prev").on("click.stop",function(){return r.prev()}).child(new Xt("chevron-left")),l("a","calendar-next").on("click.stop",function(){return r.next()}).child(new Xt("chevron-right")))),l("table","calendar-body").children(l("thead","").child((n=l("tr","")).children.apply(n,Kt(L("calendar.weeks").map(function(t){return l("th","cell").child(t)})))),this.bodyEl)),this.selectChange=function(){}}var e,n,r;return e=t,(n=[{key:"setValue",value:function(t){this.value=t,this.cvalue=new Date(t),this.buildAll()}},{key:"prev",value:function(){Zt(this.value,-1),this.buildAll()}},{key:"next",value:function(){Zt(this.value,1),this.buildAll()}},{key:"buildAll",value:function(){this.buildHeaderLeft(),this.buildBody()}},{key:"buildHeaderLeft",value:function(){var t=this.value;this.headerLeftEl.html("".concat(L("calendar.months")[t.getMonth()]," ").concat(t.getFullYear()))}},{key:"buildBody",value:function(){var t,e=this,n=this.value,r=this.cvalue,i=this.bodyEl,o=function(t,e,n){for(var r=new Date(t,e,1,23,59,59),i=[[],[],[],[],[],[]],o=0;o<6;o+=1)for(var l=0;l<7;l+=1){var a=Gt(r,7*o+l),c=a.getMonth()!==e,u=a.getMonth()===n.getMonth()&&a.getDate()===n.getDate();i[o][l]={d:a,disabled:c,active:u}}return i}(n.getFullYear(),n.getMonth(),r).map(function(t){var n,r=t.map(function(t){var n="cell";return t.disabled&&(n+=" disabled"),t.active&&(n+=" active"),l("td","").child(l("div",n).on("click.stop",function(){e.selectChange(t.d)}).child(t.d.getDate().toString()))});return(n=l("tr","")).children.apply(n,Kt(r))});(t=i.html("")).children.apply(t,Kt(o))}}])&&Jt(e.prototype,n),r&&Jt(e,r),t}();function te(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ee=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.calendar=new Qt(new Date),this.el=l("div","".concat(bt,"-datepicker")).child(this.calendar.el).hide()}var e,n,r;return e=t,(n=[{key:"setValue",value:function(t){var e=this.calendar;return"string"==typeof t?/^\d{4}-\d{1,2}-\d{1,2}$/.test(t)&&e.setValue(new Date(t.replace(new RegExp("-","g"),"/"))):t instanceof Date&&e.setValue(t),this}},{key:"change",value:function(t){var e=this;this.calendar.selectChange=function(n){t(n),e.hide()}}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide()}}])&&te(e.prototype,n),r&&te(e,r),t}();function ne(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function re(){if(!/^\s*$/.test(this.inputText)){var t=this.textlineEl,e=this.textEl,n=this.areaOffset,r=t.offset().width+9,i=this.viewFn().width-n.left-9;if(r>n.width){var o=r;if(r>i){o=i;var l=parseInt(r/i,10);l+=r%i>0?1:0,(l*=this.rowHeight)>n.height&&e.css("height","".concat(l,"px"))}e.css("width","".concat(o,"px"))}}}function ie(t,e){var n=this.textEl,r=this.textlineEl;n.el.blur(),n.val(t),r.html(t),this.change("input",t),function(t){var e=this.textEl.el;setTimeout(function(){e.focus(),e.setSelectionRange(t,t)},0)}.call(this,e)}var oe=function(){function t(e,n,r){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.viewFn=n,this.rowHeight=r,this.formulas=e,this.suggest=new Lt(e,function(t){(function(t){var e=this.inputText,n=this.validator,r=0;if(n&&"list"===n.type)this.inputText=t,r=this.inputText.length;else{var i=e.lastIndexOf("="),o=e.substring(0,i+1),l=e.substring(i+1);l=-1!==l.indexOf(")")?l.substring(l.indexOf(")")):"",this.inputText="".concat(o+t.key,"("),r=this.inputText.length,this.inputText+=")".concat(l)}ie.call(this,this.inputText,r)}).call(i,t)}),this.datepicker=new ee,this.datepicker.change(function(t){i.setText(function(t){var e=t.getMonth()+1,n=t.getDate();return e<10&&(e="0".concat(e)),n<10&&(n="0".concat(n)),"".concat(t.getFullYear(),"-").concat(e,"-").concat(n)}(t)),i.clear()}),this.areaEl=l("div","".concat(bt,"-editor-area")).children(this.textEl=l("textarea","").on("input",function(t){return function(t){var e=t.target.value,n=this.suggest,r=this.textlineEl,i=this.validator,o=this.cell;if(null!==o)if("editable"in o&&1==o.editable||void 0===o.editable){if(this.inputText=e,i)"list"===i.type?n.search(e):n.hide();else{var l=e.lastIndexOf("=");-1!==l?n.search(e.substring(l+1)):n.hide()}r.html(e),re.call(this),this.change("input",e)}else t.target.value="";else{if(this.inputText=e,i)"list"===i.type?n.search(e):n.hide();else{var a=e.lastIndexOf("=");-1!==a?n.search(e.substring(a+1)):n.hide()}r.html(e),re.call(this),this.change("input",e)}}.call(i,t)}),this.textlineEl=l("div","textline"),this.suggest.el,this.datepicker.el).on("mousemove.stop",function(){}).on("mousedown.stop",function(){}),this.el=l("div","".concat(bt,"-editor")).child(this.areaEl).hide(),this.suggest.bindInputEvents(this.textEl),this.areaOffset=null,this.freeze={w:0,h:0},this.cell=null,this.inputText="",this.change=function(){}}var e,n,r;return e=t,(n=[{key:"setFreezeLengths",value:function(t,e){this.freeze.w=t,this.freeze.h=e}},{key:"clear",value:function(){""!==this.inputText&&this.change("finished",this.inputText),this.cell=null,this.areaOffset=null,this.inputText="",this.el.hide(),this.textEl.val(""),this.textlineEl.html(""),function(){this.suggest.setItems(this.formulas)}.call(this),this.datepicker.hide()}},{key:"setOffset",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top",n=this.textEl,r=this.areaEl,i=this.suggest,o=this.freeze,l=this.el;if(t){this.areaOffset=t;var a=t.left,c=t.top,u=t.width,s=t.height,f=t.l,h=t.t,p={left:0,top:0};o.w>f&&o.h>h||(o.w<f&&o.h<h?(p.left=o.w,p.top=o.h):o.w>f?p.top=o.h:o.h>h&&(p.left=o.w)),l.offset(p),r.offset({left:a-p.left-.8,top:c-p.top-.8}),n.offset({width:u-9+.8,height:s-3+.8});var y={left:0};y[e]=s,i.setOffset(y),i.hide()}}},{key:"setCell",value:function(t,e){var n=this.el,r=this.datepicker,i=this.suggest;n.show(),this.cell=t;var o=t&&t.text||"";if(this.setText(o),this.validator=e,e){var l=e.type;"date"===l&&(r.show(),/^\s*$/.test(o)||r.setValue(o)),"list"===l&&(i.setItems(e.values()),i.search(""))}}},{key:"setText",value:function(t){this.inputText=t,ie.call(this,t,t.length),re.call(this)}}])&&ne(e.prototype,n),r&&ne(e,r),t}();function le(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ae(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ce=[{key:"copy",title:q("contextmenu.copy"),label:"Ctrl+C"},{key:"cut",title:q("contextmenu.cut"),label:"Ctrl+X"},{key:"paste",title:q("contextmenu.paste"),label:"Ctrl+V"},{key:"paste-value",title:q("contextmenu.pasteValue"),label:"Ctrl+Shift+V"},{key:"paste-format",title:q("contextmenu.pasteFormat"),label:"Ctrl+Alt+V"},{key:"divider"},{key:"insert-row",title:q("contextmenu.insertRow")},{key:"insert-column",title:q("contextmenu.insertColumn")},{key:"divider"},{key:"delete-row",title:q("contextmenu.deleteRow")},{key:"delete-column",title:q("contextmenu.deleteColumn")},{key:"delete-cell-text",title:q("contextmenu.deleteCellText")},{key:"divider"},{key:"validation",title:q("contextmenu.validation")},{key:"divider"},{key:"cell-printable",title:q("contextmenu.cellprintable")},{key:"cell-non-printable",title:q("contextmenu.cellnonprintable")},{key:"divider"},{key:"cell-editable",title:q("contextmenu.celleditable")},{key:"cell-non-editable",title:q("contextmenu.cellnoneditable")}];function ue(){var t=this;return ce.map(function(e){return function(t){var e=this;return"divider"===t.key?l("div","".concat(bt,"-item divider")):l("div","".concat(bt,"-item")).on("click",function(){e.itemClick(t.key),e.hide()}).children(t.title(),l("div","label").child(t.label||""))}.call(t,e)})}var se=function(){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=(n=l("div","".concat(bt,"-contextmenu"))).children.apply(n,le(ue.call(this))).hide(),this.viewFn=e,this.itemClick=function(){},this.isHide=r}var e,n,r;return e=t,(n=[{key:"hide",value:function(){var t=this.el;t.hide(),pt(t)}},{key:"setPosition",value:function(t,e){if(!this.isHide){var n=this.el,r=n.show().offset(),i=r.height,o=r.width,l=this.viewFn(),a=e,c=t;l.height-e<=i&&(a-=i),l.width-t<=o&&(c-=o),n.offset({left:c,top:a}),yt(n)}}}])&&ae(e.prototype,n),r&&ae(e,r),t}(),fe=[{key:"Arial",title:"Arial"},{key:"Helvetica",title:"Helvetica"},{key:"Source Sans Pro",title:"Source Sans Pro"},{key:"Comic Sans MS",title:"Comic Sans MS"},{key:"Courier New",title:"Courier New"},{key:"Verdana",title:"Verdana"},{key:"Lato",title:"Lato"}],he=[{pt:7.5,px:10},{pt:8,px:11},{pt:9,px:12},{pt:10,px:13},{pt:10.5,px:14},{pt:11,px:15},{pt:12,px:16},{pt:14,px:18.7},{pt:15,px:20},{pt:16,px:21.3},{pt:18,px:24},{pt:22,px:29.3},{pt:24,px:32},{pt:26,px:34.7},{pt:36,px:48},{pt:42,px:56}];function pe(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var l,a=t[Symbol.iterator]();!(r=(l=a.next()).done)&&(n.push(l.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var ye=function(t){for(var e=[],n=[],r=[],i=0,o="",l=1,a=0;a<t.length;a+=1){var c=t.charAt(a);if(" "!==c)if(c>="a"&&c<="z")r.push(c.toUpperCase());else if(c>="0"&&c<="9"||c>="A"&&c<="Z"||"."===c)r.push(c);else if('"'===c){for(a+=1;'"'!==t.charAt(a);)r.push(t.charAt(a)),a+=1;n.push('"'.concat(r.join(""))),r=[]}else{if("("!==c&&r.length>0&&n.push(r.join("")),")"===c){var u=e.pop();if(2===i)try{for(var s=pe(f(n.pop()),2),p=s[0],y=s[1],d=pe(f(n.pop()),2),v=d[0],b=d[1],g=0,m=v;m<=p;m+=1)for(var w=b;w<=y;w+=1)n.push(h(m,w)),g+=1;n.push([u,g])}catch(t){}else if(1===i||3===i)3===i&&n.push(o),n.push([u,l]),l=1;else for(;"("!==u&&(n.push(u),!(e.length<=0));)u=e.pop();i=0}else if("="===c||">"===c||"<"===c){var k=t.charAt(a+1);o=c,"="!==k&&"-"!==k||(o+=k,a+=1),i=3}else if(":"===c)i=2;else if(","===c)3===i&&n.push(o),i=1,l+=1;else if("("===c&&r.length>0)e.push(r.join(""));else{if(e.length>0&&("+"===c||"-"===c)){var O=e[e.length-1];if("("!==O&&n.push(e.pop()),"*"===O||"/"===O)for(;e.length>0&&"("!==(O=e[e.length-1]);)n.push(e.pop())}e.push(c)}r=[]}}for(r.length>0&&n.push(r.join(""));e.length>0;)n.push(e.pop());return n},de=function(t,e){if(t[0]>="0"&&t[0]<="9")return Number(t);if('"'===t[0])return t.substring(1);var n=pe(f(t),2);return e(n[0],n[1])},ve=function(t,e,n,r){for(var i=[],o=0;o<t.length;o+=1){var l=t[o],a=l[0];if("+"===l){var c=i.pop();i.push(Number(i.pop())+Number(c))}else if("-"===l)if(1===i.length){var u=i.pop();i.push(-1*Number(u))}else{var s=i.pop();i.push(Number(i.pop())-Number(s))}else if("*"===l)i.push(Number(i.pop())*Number(i.pop()));else if("/"===l){var f=i.pop();i.push(Number(i.pop())/Number(f))}else if("="===a||">"===a||"<"===a){var h=i.pop(),p=Function;i.push(new p("return ".concat(i.pop()," ").concat("="===l?"==":l," ").concat(h))())}else if(Array.isArray(l)){for(var y=pe(l,2),d=y[0],v=y[1],b=[],g=0;g<v;g+=1)b.push(i.pop());i.push(e[d].render(b.reverse()))}else{if(r.includes(l))return 0;(a>="a"&&a<="z"||a>="A"&&a<="Z")&&r.push(l),i.push(de(l,n))}}return i[0]},be={render:function t(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if("="===e[0]){var o=ye(e.substring(1));return o.length<=0?e:ve(o,n,function(e,o){return t(r(e,o),n,r,i)},i)}return e}};function ge(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var l,a=t[Symbol.iterator]();!(r=(l=a.next()).done)&&(n.push(l.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function me(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var we=[{key:"SUM",title:q("formula.sum"),render:function(t){return t.reduce(function(t,e){return Number(t)+Number(e)},0)}},{key:"AVERAGE",title:q("formula.average"),render:function(t){return t.reduce(function(t,e){return Number(t)+Number(e)},0)/t.length}},{key:"MAX",title:q("formula.max"),render:function(t){return Math.max.apply(Math,me(t.map(function(t){return Number(t)})))}},{key:"MIN",title:q("formula.min"),render:function(t){return Math.min.apply(Math,me(t.map(function(t){return Number(t)})))}},{key:"IF",title:q("formula._if"),render:function(t){var e=ge(t,3),n=e[0],r=e[1],i=e[2];return n?r:i}},{key:"AND",title:q("formula.and"),render:function(t){return t.every(function(t){return t})}},{key:"OR",title:q("formula.or"),render:function(t){return t.some(function(t){return t})}},{key:"CONCAT",title:q("formula.concat"),render:function(t){return t.join("")}}],ke=we,Oe={};function Se(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||Ee(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function xe(t){return function(t){if(Array.isArray(t))return t}(t)||Ee(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Ee(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}we.forEach(function(t){Oe[t.key]=t});var je=function(t){return t},_e=function(t){if(/^(-?\d*.?\d*)$/.test(t)){var e=xe(Number(t).toFixed(2).toString().split("\\.")),n=e[0],r=e.slice(1);return[n.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")].concat(Se(r))}return t},Ce=[{key:"normal",title:q("format.normal"),type:"string",render:je},{key:"text",title:q("format.text"),type:"string",render:je},{key:"number",title:q("format.number"),type:"number",label:"1,000.12",render:_e},{key:"percent",title:q("format.percent"),type:"number",label:"10.12%",render:function(t){return"".concat(t,"%")}},{key:"rmb",title:q("format.rmb"),type:"number",label:"￥10.00",render:function(t){return"￥".concat(_e(t))}},{key:"usd",title:q("format.usd"),type:"number",label:"$10.00",render:function(t){return"$".concat(_e(t))}},{key:"eur",title:q("format.eur"),type:"number",label:"€10.00",render:function(t){return"€".concat(_e(t))}},{key:"date",title:q("format.date"),type:"date",label:"26/09/2008",render:je},{key:"time",title:q("format.time"),type:"date",label:"15:59:00",render:je},{key:"datetime",title:q("format.datetime"),type:"date",label:"26/09/2008 15:59:00",render:je},{key:"duration",title:q("format.duration"),type:"date",label:"24:01:00",render:je}],Te={};function Pe(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Ae(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var l,a=t[Symbol.iterator]();!(r=(l=a.next()).done)&&(n.push(l.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Re(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function De(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ze(t,e,n){return e&&De(t.prototype,e),n&&De(t,n),t}function Ie(){return window.devicePixelRatio||1}function We(){return Ie()-.5}function Me(t){return parseInt(t*Ie(),10)}function Fe(t){var e=Me(t);return e>0?e-.5:.5}Ce.forEach(function(t){Te[t.key]=t});var Ne=function(){function t(e,n,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;Re(this,t),this.x=e,this.y=n,this.width=r,this.height=i,this.padding=o,this.bgcolor="#ffffff",this.borderTop=null,this.borderRight=null,this.borderBottom=null,this.borderLeft=null}return ze(t,[{key:"setBorders",value:function(t){var e=t.top,n=t.bottom,r=t.left,i=t.right;e&&(this.borderTop=e),i&&(this.borderRight=i),n&&(this.borderBottom=n),r&&(this.borderLeft=r)}},{key:"innerWidth",value:function(){return this.width-2*this.padding}},{key:"innerHeight",value:function(){return this.height-2*this.padding}},{key:"textx",value:function(t){var e=this.width,n=this.padding,r=this.x;return"left"===t?r+=n:"center"===t?r+=e/2:"right"===t&&(r+=e-n),r}},{key:"texty",value:function(t,e,n){var r=this.height,i=this.padding,o=this.y;return"top"===t?o+=i:"middle"===t?o=o+r/2-n:"bottom"===t&&(o+=r-2*n-i),o}},{key:"topxys",value:function(){var t=this.x,e=this.y;return[[t,e],[t+this.width,e]]}},{key:"rightxys",value:function(){var t=this.x,e=this.y,n=this.width;return[[t+n,e],[t+n,e+this.height]]}},{key:"bottomxys",value:function(){var t=this.x,e=this.y,n=this.width,r=this.height;return[[t,e+r],[t+n,e+r]]}},{key:"leftxys",value:function(){var t=this.x,e=this.y;return[[t,e],[t,e+this.height]]}}]),t}();function He(t,e,n,r,i,o,l){var a={x:0,y:0};"underline"===t?a.y="bottom"===i?0:"top"===i?-(o+2):-o/2:"strike"===t&&("bottom"===i?a.y=o/2:"top"===i&&(a.y=-(o/2+2))),"center"===r?a.x=l/2:"right"===r&&(a.x=l),this.line([e-a.x,n-a.y],[e-a.x+l,n-a.y])}var Ve=function(){function t(e,n,r){Re(this,t),this.el=e,this.ctx=e.getContext("2d"),this.resize(n,r),this.ctx.scale(Ie(),Ie())}return ze(t,[{key:"resize",value:function(t,e){this.el.style.width="".concat(t,"px"),this.el.style.height="".concat(e,"px"),this.el.width=Me(t),this.el.height=Me(e)}},{key:"clear",value:function(){var t=this.el,e=t.width,n=t.height;return this.ctx.clearRect(0,0,e,n),this}},{key:"attr",value:function(t){return Object.assign(this.ctx,t),this}},{key:"save",value:function(){return this.ctx.save(),this.ctx.beginPath(),this}},{key:"restore",value:function(){return this.ctx.restore(),this}},{key:"beginPath",value:function(){return this.ctx.beginPath(),this}},{key:"translate",value:function(t,e){return this.ctx.translate(Me(t),Me(e)),this}},{key:"clearRect",value:function(t,e,n,r){return this.ctx.clearRect(t,e,n,r),this}},{key:"fillRect",value:function(t,e,n,r){return this.ctx.fillRect(Me(t)-.5,Me(e)-.5,Me(n),Me(r)),this}},{key:"fillText",value:function(t,e,n){return this.ctx.fillText(t,Me(e),Me(n)),this}},{key:"text",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=this.ctx,o=n.align,l=n.valign,a=n.font,c=n.color,u=n.strike,s=n.underline,f=e.textx(o);i.save(),i.beginPath(),this.attr({textAlign:o,textBaseline:l,font:"".concat(a.italic?"italic":""," ").concat(a.bold?"bold":""," ").concat(Me(a.size),"px ").concat(a.name),fillStyle:c,strokeStyle:c});var h=i.measureText(t).width,p=0;if(r){var y=Math.ceil(h/e.innerWidth());p=(y-1)*a.size/2}var d=e.texty(l,a.size,p);if(r&&h>e.innerWidth()){for(var v={len:0,start:0},b=0;b<t.length;b+=1)v.len>=e.innerWidth()&&(this.fillText(t.substring(v.start,b),f,d),u&&He.call(this,"strike",f,d,o,l,a.size,v.len),s&&He.call(this,"underline",f,d,o,l,a.size,v.len),d+=a.size+2,v.len=0,v.start=b),v.len+=i.measureText(t[b]).width;v.len>0&&(this.fillText(t.substring(v.start),f,d),u&&He.call(this,"strike",f,d,o,l,a.size,v.len),s&&He.call(this,"underline",f,d,o,l,a.size,v.len))}else this.fillText(t,f,d),u&&He.call(this,"strike",f,d,o,l,a.size,h),s&&He.call(this,"underline",f,d,o,l,a.size,h);return i.restore(),this}},{key:"border",value:function(t,e){var n=this.ctx;return n.lineWidth=We,n.strokeStyle=e,"medium"===t?n.lineWidth=Me(2)-.5:"thick"===t?n.lineWidth=Me(3):"dashed"===t?n.setLineDash([Me(3),Me(2)]):"dotted"===t?n.setLineDash([Me(1),Me(1)]):"double"===t&&n.setLineDash([Me(2),0]),this}},{key:"line",value:function(){var t=this.ctx;if(arguments.length>1){var e=arguments.length<=0?void 0:arguments[0],n=Ae(e,2),r=n[0],i=n[1];t.moveTo(Fe(r),Fe(i));for(var o=1;o<arguments.length;o+=1){var l=o<0||arguments.length<=o?void 0:arguments[o],a=Ae(l,2),c=a[0],u=a[1];t.lineTo(Fe(c),Fe(u))}t.stroke()}return this}},{key:"strokeBorders",value:function(t){var e=this.ctx;e.save(),e.beginPath();var n=t.borderTop,r=t.borderRight,i=t.borderBottom,o=t.borderLeft;n&&(this.border.apply(this,Pe(n)),this.line.apply(this,Pe(t.topxys()))),r&&(this.border.apply(this,Pe(r)),this.line.apply(this,Pe(t.rightxys()))),i&&(this.border.apply(this,Pe(i)),this.line.apply(this,Pe(t.bottomxys()))),o&&(this.border.apply(this,Pe(o)),this.line.apply(this,Pe(t.leftxys()))),e.restore()}},{key:"dropdown",value:function(t){var e=this.ctx,n=t.x,r=t.y,i=n+t.width-15,o=r+t.height-15;e.save(),e.beginPath(),e.moveTo(Me(i),Me(o)),e.lineTo(Me(i+8),Me(o)),e.lineTo(Me(i+4),Me(o+6)),e.closePath(),e.fillStyle="rgba(0, 0, 0, .45)",e.fill(),e.restore()}},{key:"error",value:function(t){var e=this.ctx,n=t.x,r=t.y,i=n+t.width-1;e.save(),e.beginPath(),e.moveTo(Me(i-8),Me(r-1)),e.lineTo(Me(i),Me(r-1)),e.lineTo(Me(i),Me(r+8)),e.closePath(),e.fillStyle="rgba(255, 0, 0, .65)",e.fill(),e.restore()}},{key:"frozen",value:function(t){var e=this.ctx,n=t.x,r=t.y,i=n+t.width-1;e.save(),e.beginPath(),e.moveTo(Me(i-8),Me(r-1)),e.lineTo(Me(i),Me(r-1)),e.lineTo(Me(i),Me(r+8)),e.closePath(),e.fillStyle="rgba(0, 255, 0, .85)",e.fill(),e.restore()}},{key:"rect",value:function(t,e){var n=this.ctx,r=t.x,i=t.y,o=t.width,l=t.height,a=t.bgcolor;n.save(),n.beginPath(),n.fillStyle=a||"#fff",n.rect(Fe(r+1),Fe(i+1),Me(o-2),Me(l-2)),n.clip(),n.fill(),e(),n.restore()}}]),t}();function Le(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var l,a=t[Symbol.iterator]();!(r=(l=a.next()).done)&&(n.push(l.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function qe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Be=5,Ue={fillStyle:"#f4f5f8"},Ye={fillStyle:"#fff",lineWidth:We,strokeStyle:"#e6e6e6"};function $e(t,e){var n=this.data.cellRect(t,e),r=n.left,i=n.top,o=n.width,l=n.height;return new Ne(r,i,o,l,Be)}function Xe(t,e){var n=this.draw,r=this.data,i=r.sortedRowMap,o=t;i.has(t)&&(o=i.get(t));var l=r.getCell(o,e),a=r.validations.get(t,e),c=$e.call(this,t,e);if(a&&n.dropdown(c),null!==l){var u=!1;"editable"in l&&0==l.editable&&(u=!0);var s=r.getCellStyleOrDefault(o,e);c.bgcolor=s.bgcolor,void 0!==s.border&&(c.setBorders(s.border),n.strokeBorders(c)),n.rect(c,function(){var i=be.render(l.text||"",Oe,function(t,e){return r.getCellTextOrDefault(e,t)});s.format&&(i=Te[s.format].render(i));var o=Object.assign({},s.font);o.size=function(t){for(var e=0;e<he.length;e+=1){var n=he[e];if(n.pt===t)return n.px}return t}(o.size),n.text(i,c,{align:s.align,valign:s.valign,font:o,color:s.color,strike:s.strike,underline:s.underline},s.textwrap);var f=r.validations.getError(t,e);f&&console.log(f),a&&n.dropdown(c),f&&n.error(c),u&&n.frozen(c)})}}function Ke(t,e,n,r,i){var o=this,l=this.draw,a=this.data;l.save(),l.translate(e,n).translate(r,i);var c=a.exceptRowSet,u=a.exceptRowTotalHeight(t.sri,t.eri);l.save(),l.translate(0,-u),t.each(function(t,e){Xe.call(o,t,e)},function(t){return function(t){var e=c.has(t);if(e){var n=a.rows.getHeight(t);l.translate(0,-n)}return!e}(t)}),l.restore();var s=new Set;l.save(),l.translate(0,-u),a.eachMergesInView(t,function(t){var e=t.sri,n=t.sci,r=t.eri;if(c.has(e)){if(!s.has(e)){s.add(e);var i=a.rows.sumHeight(e,r+1);l.translate(0,-i)}}else Xe.call(o,e,n)}),l.restore(),function(t){var e=this,n=this.data,r=this.draw;if(t){var i=n.autoFilter;if(!i.active())return;var o=i.hrange();t.intersects(o)&&o.each(function(t,n){var i=$e.call(e,t,n);r.dropdown(i)})}}.call(this,t),l.restore()}function Je(t,e,n,r){var i=this.draw;i.save(),i.attr({fillStyle:"rgba(75, 137, 255, 0.08)"}).fillRect(t,e,n,r),i.restore()}function Ze(t,e,n,r,i,o){var l=this,a=this.draw,c=this.data,s=e.h,f=e.w,h=o+r,p=i+n;a.save(),a.attr(Ue),"all"!==t&&"left"!==t||a.fillRect(0,h,n,s),"all"!==t&&"top"!==t||a.fillRect(p,0,f,r);var y=c.selector.range,d=y.sri,v=y.sci,b=y.eri,g=y.eci;a.attr({textAlign:"center",textBaseline:"middle",font:"500 ".concat(Me(12),"px Source Sans Pro"),fillStyle:"#585757",lineWidth:We(),strokeStyle:"#e6e6e6"}),"all"!==t&&"left"!==t||(c.rowEach(e.sri,e.eri,function(t,e,r){var i=h+e,o=t;a.line([0,i],[n,i]),d<=o&&o<b+1&&Je.call(l,0,i,n,r),a.fillText(o+1,n/2,i+r/2)}),a.line([0,s+h],[n,s+h]),a.line([n,h],[n,s+h])),"all"!==t&&"top"!==t||(c.colEach(e.sci,e.eci,function(t,e,n){var i=p+e,o=t;a.line([i,0],[i,r]),v<=o&&o<g+1&&Je.call(l,i,0,n,r),a.fillText(u(o),i+n/2,r/2)}),a.line([f+p,0],[f+p,r]),a.line([0,r],[f+p,r])),a.restore()}function Ge(t,e,n,r,i){var o=t.sri,l=t.sci,a=t.eri,c=t.eci,u=t.w,s=t.h,f=this.draw,h=this.data,p=h.settings;f.save(),f.attr(Ye).translate(e+r,n+i),f.clearRect(0,0,u,s),p.showGrid?(h.rowEach(o,a,function(t,e,n){t!==o&&f.line([0,e],[u,e]),t===a&&f.line([0,e+n],[u,e+n])}),h.colEach(l,c,function(t,e,n){t!==l&&f.line([e,0],[e,s]),t===c&&f.line([e+n,0],[e+n,s])}),f.restore()):f.restore()}var Qe=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=e,this.draw=new Ve(e,n.viewWidth(),n.viewHeight()),this.data=n}var e,n,r;return e=t,(n=[{key:"render",value:function(){var t=this.data,e=t.rows,n=t.cols.indexWidth,r=e.height;this.draw.resize(t.viewWidth(),t.viewHeight()),this.clear();var i=t.viewRange(),o=t.freezeTotalWidth(),l=t.freezeTotalHeight(),a=t.scroll,c=a.x,s=a.y;Ge.call(this,i,n,r,o,l),Ke.call(this,i,n,r,-c,-s),Ze.call(this,"all",i,n,r,o,l),function(t,e){var n=this.draw;n.save(),n.attr({fillStyle:"#f4f5f8"}).fillRect(0,0,t,e),n.restore()}.call(this,n,r);var f=Le(t.freeze,2),h=f[0],p=f[1];if(h>0||p>0){if(h>0){var y=i.clone();y.sri=0,y.eri=h-1,y.h=l,Ge.call(this,y,n,r,o,0),Ke.call(this,y,n,r,-c,0),Ze.call(this,"top",y,n,r,o,0)}if(p>0){var d=i.clone();d.sci=0,d.eci=p-1,d.w=o,Ge.call(this,d,n,r,0,l),Ze.call(this,"left",d,n,r,0,l),Ke.call(this,d,n,r,0,-s)}var v=t.freezeViewRange();Ge.call(this,v,n,r,0,0),Ze.call(this,"all",v,n,r,0,0),Ke.call(this,v,n,r,0,0),function(t,e,n,r){var i=this.draw,o=this.data,l=o.viewWidth()-t,a=o.viewHeight()-e;i.save().translate(t,e).attr({strokeStyle:"rgba(75, 137, 255, .6)"}),i.line([0,r],[l,r]),i.line([n,0],[n,a]),i.restore()}.call(this,n,r,o,l);var b={textAlign:"center",textBaseline:"middle",font:"500 ".concat(Me(12),"px Source Sans Pro"),fillStyle:"#585757",lineWidth:We(),strokeStyle:"#e6e6e6"};this.draw.attr(b),this.draw.fillText(u(this.data.selector.ci)+(this.data.selector.ri+1),30,12.5)}}},{key:"clear",value:function(){this.draw.clear()}}])&&qe(e.prototype,n),r&&qe(e,r),t}();function tn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var en=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tip=L("toolbar.".concat(e.replace(/-[a-z]/g,function(t){return t[1].toUpperCase()}))),this.tag=e,this.shortcut=n,this.value=r,this.el=this.element(),this.change=function(){}}var e,n,r;return e=t,(n=[{key:"element",value:function(){var t=this.tip;return l("div","".concat(bt,"-toolbar-btn")).on("mouseenter",function(e){!function(t,e){if(!e.classList.contains("active")){var n=e.getBoundingClientRect(),r=n.left,i=n.top,o=n.width,a=n.height,c=l("div","".concat(bt,"-tooltip")).html(t).show();document.body.appendChild(c.el);var u=c.box();c.css("left","".concat(r+o/2-u.width/2,"px")).css("top","".concat(i+a+2,"px")),ft(e,"mouseleave",function(){document.body.contains(c.el)&&document.body.removeChild(c.el)}),ft(e,"click",function(){document.body.contains(c.el)&&document.body.removeChild(c.el)})}}(t,e.target)}).attr("data-tooltip",t)}},{key:"setState",value:function(){}}])&&tn(e.prototype,n),r&&tn(e,r),t}();function nn(t){return(nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function on(t,e){return!e||"object"!==nn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ln(t,e,n){return(ln="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=an(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function an(t){return(an=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function cn(t,e){return(cn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var un=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),on(this,an(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&cn(t,e)}(e,en),n=e,(r=[{key:"dropdown",value:function(){}},{key:"getValue",value:function(t){return t}},{key:"element",value:function(){var t=this,n=this.tag;return this.dd=this.dropdown(),this.dd.change=function(e){return t.change(n,t.getValue(e))},ln(an(e.prototype),"element",this).call(this).child(this.dd)}},{key:"setState",value:function(t){t&&(this.value=t,this.dd.setTitle(t))}}])&&rn(n.prototype,r),i&&rn(n,i),e}();function sn(t){return(sn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function hn(t,e){return!e||"object"!==sn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pn(t){return(pn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yn(t,e){return(yn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var dn=function(t){function e(t,n,r,i){var o,a;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(a=hn(this,pn(e).call(this,"div","".concat(bt,"-dropdown ").concat(i)))).title=t,a.change=function(){},"string"==typeof t?a.title=l("div","".concat(bt,"-dropdown-title")).child(t):r&&a.title.addClass("arrow-left");for(var c=arguments.length,u=new Array(c>4?c-4:0),s=4;s<c;s++)u[s-4]=arguments[s];return a.contentEl=(o=l("div","".concat(bt,"-dropdown-content"))).children.apply(o,u).css("width",n).hide(),a.headerEl=l("div","".concat(bt,"-dropdown-header")),a.headerEl.on("click",function(){"block"!==a.contentEl.css("display")?a.show():a.hide()}).children(a.title,r?l("div","".concat(bt,"-icon arrow-right")).child(l("div","".concat(bt,"-icon-img arrow-down"))):""),a.children(a.headerEl,a.contentEl),a}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yn(t,e)}(e,o),n=e,(r=[{key:"setTitle",value:function(t){this.title.html(t),this.hide()}},{key:"show",value:function(){var t=this;this.contentEl.show(),this.parent().active(),yt(this.parent(),function(){t.hide()})}},{key:"hide",value:function(){this.parent().active(!1),this.contentEl.hide(),pt(this.parent())}}])&&fn(n.prototype,r),i&&fn(n,i),e}();function vn(t){return(vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bn(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function gn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function mn(t,e){return!e||"object"!==vn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function wn(t){return(wn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function kn(t,e){return(kn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var On=function(t){function e(t,n){var r,i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=new Xt("align-".concat(n)),a=t.map(function(t){return(e="align-".concat(t),l("div","".concat(bt,"-item")).child(new Xt(e))).on("click",function(){i.setTitle(t),i.change(t)});var e});return i=mn(this,(r=wn(e)).call.apply(r,[this,o,"auto",!0,"bottom-left"].concat(bn(a))))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&kn(t,e)}(e,dn),n=e,(r=[{key:"setTitle",value:function(t){this.title.setName("align-".concat(t)),this.hide()}}])&&gn(n.prototype,r),i&&gn(n,i),e}();function Sn(t){return(Sn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function En(t,e){return!e||"object"!==Sn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function jn(t){return(jn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _n(t,e){return(_n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Cn=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),En(this,jn(e).call(this,"align","",t))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_n(t,e)}(e,un),n=e,(r=[{key:"dropdown",value:function(){var t=this.value;return new On(["left","center","right"],t)}}])&&xn(n.prototype,r),i&&xn(n,i),e}();function Tn(t){return(Tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function An(t,e){return!e||"object"!==Tn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Rn(t){return(Rn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Dn(t,e){return(Dn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var zn=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),An(this,Rn(e).call(this,"valign","",t))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Dn(t,e)}(e,un),n=e,(r=[{key:"dropdown",value:function(){var t=this.value;return new On(["top","middle","bottom"],t)}}])&&Pn(n.prototype,r),i&&Pn(n,i),e}();function In(t){return(In="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Mn(t,e){return!e||"object"!==In(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Fn(t,e,n){return(Fn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Nn(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Nn(t){return(Nn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Hn(t,e){return(Hn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Vn=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Mn(this,Nn(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Hn(t,e)}(e,en),n=e,(r=[{key:"element",value:function(){var t=this,n=this.tag;return Fn(Nn(e.prototype),"element",this).call(this).child(new Xt(n)).on("click",function(){return t.click()})}},{key:"click",value:function(){this.change(this.tag,this.toggle())}},{key:"setState",value:function(t){this.el.active(t)}},{key:"toggle",value:function(){return this.el.toggle()}},{key:"active",value:function(){return this.el.hasClass("active")}}])&&Wn(n.prototype,r),i&&Wn(n,i),e}();function Ln(t){return(Ln="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Bn(t,e){return!e||"object"!==Ln(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Un(t){return(Un=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Yn(t,e){return(Yn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var $n=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Bn(this,Un(e).call(this,"autofilter"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yn(t,e)}(e,Vn),n=e,(r=[{key:"setState",value:function(){}}])&&qn(n.prototype,r),i&&qn(n,i),e}();function Xn(t){return(Xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Kn(t,e){return!e||"object"!==Xn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Jn(t){return(Jn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Zn(t,e){return(Zn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Gn=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Kn(this,Jn(e).call(this,"font-bold","Ctrl+B"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zn(t,e)}(e,Vn),e}();function Qn(t){return(Qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tr(t,e){return!e||"object"!==Qn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function er(t){return(er=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function nr(t,e){return(nr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var rr=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),tr(this,er(e).call(this,"font-italic","Ctrl+I"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&nr(t,e)}(e,Vn),e}();function ir(t){return(ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function or(t,e){return!e||"object"!==ir(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function lr(t){return(lr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ar(t,e){return(ar=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var cr=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),or(this,lr(e).call(this,"strike","Ctrl+U"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ar(t,e)}(e,Vn),e}();function ur(t){return(ur="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sr(t,e){return!e||"object"!==ur(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function fr(t){return(fr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function hr(t,e){return(hr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var pr=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),sr(this,fr(e).call(this,"underline","Ctrl+U"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&hr(t,e)}(e,Vn),e}();function yr(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var dr=["#ffffff","#000100","#e7e5e6","#445569","#5b9cd6","#ed7d31","#a5a5a5","#ffc001","#4371c6","#71ae47"],vr=[["#f2f2f2","#7f7f7f","#d0cecf","#d5dce4","#deeaf6","#fce5d5","#ededed","#fff2cd","#d9e2f3","#e3efd9"],["#d8d8d8","#595959","#afabac","#adb8ca","#bdd7ee","#f7ccac","#dbdbdb","#ffe59a","#b3c6e7","#c5e0b3"],["#bfbfbf","#3f3f3f","#756f6f","#8596b0","#9cc2e6","#f4b184","#c9c9c9","#fed964","#8eaada","#a7d08c"],["#a5a5a5","#262626","#3a3839","#333f4f","#2e75b5","#c45a10","#7b7b7b","#bf8e01","#2f5596","#538136"],["#7f7f7f","#0c0c0c","#171516","#222a35","#1f4e7a","#843c0a","#525252","#7e6000","#203864","#365624"]],br=["#c00000","#fe0000","#fdc101","#ffff01","#93d051","#00b04e","#01b0f1","#0170c1","#012060","#7030a0"];function gr(t){var e=this;return l("td","").child(l("div","".concat(bt,"-color-palette-cell")).on("click.stop",function(){return e.change(t)}).css("background-color",t))}var mr=function t(){var e,n,r,i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=l("div","".concat(bt,"-color-palette")),this.change=function(){};var o=l("table","").children((e=l("tbody","")).children.apply(e,[(n=l("tr","".concat(bt,"-theme-color-placeholders"))).children.apply(n,yr(dr.map(function(t){return gr.call(i,t)})))].concat(yr(vr.map(function(t){var e;return(e=l("tr","".concat(bt,"-theme-colors"))).children.apply(e,yr(t.map(function(t){return gr.call(i,t)})))})),[(r=l("tr","".concat(bt,"-standard-colors"))).children.apply(r,yr(br.map(function(t){return gr.call(i,t)})))])));this.el.child(o)};function wr(t){return(wr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Or(t,e){return!e||"object"!==wr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Sr(t){return(Sr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xr(t,e){return(xr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Er=function(t){function e(t,n){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=new Xt(t).css("height","16px").css("border-bottom","3px solid ".concat(n)),o=new mr;return o.change=function(t){r.setTitle(t),r.change(t)},r=Or(this,Sr(e).call(this,i,"auto",!1,"bottom-left",o.el))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xr(t,e)}(e,dn),n=e,(r=[{key:"setTitle",value:function(t){this.title.css("border-color",t),this.hide()}}])&&kr(n.prototype,r),i&&kr(n,i),e}();function jr(t){return(jr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _r(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Cr(t,e){return!e||"object"!==jr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Tr(t){return(Tr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Pr(t,e){return(Pr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ar=[["thin",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" style="user-select: none;"></line></svg>'],["medium",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="2" style="user-select: none;"><line x1="0" y1="1.0" x2="50" y2="1.0" stroke-width="2" stroke="black" style="user-select: none;"></line></svg>'],["thick",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="3" style="user-select: none;"><line x1="0" y1="1.5" x2="50" y2="1.5" stroke-width="3" stroke="black" style="user-select: none;"></line></svg>'],["dashed",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="2" style="user-select: none;"></line></svg>'],["dotted",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="1" style="user-select: none;"></line></svg>']],Rr=function(t){function e(t){var n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=new Xt("line-type"),o=0,a=Ar.map(function(e,n){return l("div","".concat(bt,"-item state ").concat(t===e[0]?"checked":"")).on("click",function(){a[o].toggle("checked"),a[n].toggle("checked"),o=n,r.hide(),r.change(e)}).child(l("div","".concat(bt,"-line-type")).html(e[1]))});return r=Cr(this,(n=Tr(e)).call.apply(n,[this,i,"auto",!1,"bottom-left"].concat(_r(a))))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pr(t,e)}(e,dn),e}();function Dr(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function zr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var l,a=t[Symbol.iterator]();!(r=(l=a.next()).done)&&(n.push(l.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Ir(){var t;return l("table","").child((t=l("tbody","")).children.apply(t,arguments))}function Wr(t){var e=this;return l("td","").child(l("div","".concat(bt,"-border-palette-cell")).child(new Xt("border-".concat(t))).on("click",function(){e.mode=t;var n=e.mode,r=e.style,i=e.color;e.change({mode:n,style:r,color:i})}))}var Mr=function t(){var e,n,r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.color="#000",this.style="thin",this.mode="all",this.change=function(){},this.ddColor=new Er("line-color",this.color),this.ddColor.change=function(t){r.color=t},this.ddType=new Rr(this.style),this.ddType.change=function(t){var e=zr(t,1)[0];r.style=e},this.el=l("div","".concat(bt,"-border-palette"));var i=Ir(l("tr","").children(l("td","".concat(bt,"-border-palette-left")).child(Ir((e=l("tr","")).children.apply(e,Dr(["all","inside","horizontal","vertical","outside"].map(function(t){return Wr.call(r,t)}))),(n=l("tr","")).children.apply(n,Dr(["left","top","right","bottom","none"].map(function(t){return Wr.call(r,t)}))))),l("td","".concat(bt,"-border-palette-right")).children(l("div","".concat(bt,"-toolbar-btn")).child(this.ddColor.el),l("div","".concat(bt,"-toolbar-btn")).child(this.ddType.el))));this.el.child(i)};function Fr(t){return(Fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nr(t,e){return!e||"object"!==Fr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Hr(t){return(Hr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Vr(t,e){return(Vr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Lr=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=new Xt("border-all"),r=new Mr;return r.change=function(e){t.change(e),t.hide()},t=Nr(this,Hr(e).call(this,n,"auto",!1,"bottom-left",r.el))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Vr(t,e)}(e,dn),e}();function qr(t){return(qr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Br(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ur(t,e){return!e||"object"!==qr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Yr(t){return(Yr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $r(t,e){return($r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xr=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ur(this,Yr(e).call(this,"border"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$r(t,e)}(e,un),n=e,(r=[{key:"dropdown",value:function(){return new Lr}}])&&Br(n.prototype,r),i&&Br(n,i),e}();function Kr(t){return(Kr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Zr(t,e){return!e||"object"!==Kr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Gr(t,e,n){return(Gr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Qr(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Qr(t){return(Qr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ti(t,e){return(ti=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ei=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Zr(this,Qr(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ti(t,e)}(e,en),n=e,(r=[{key:"element",value:function(){var t=this;return Gr(Qr(e.prototype),"element",this).call(this).child(new Xt(this.tag)).on("click",function(){return t.change(t.tag)})}},{key:"setState",value:function(t){this.el.disabled(t)}}])&&Jr(n.prototype,r),i&&Jr(n,i),e}();function ni(t){return(ni="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ri(t,e){return!e||"object"!==ni(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ii(t){return(ii=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function oi(t,e){return(oi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var li=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ri(this,ii(e).call(this,"clearformat"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&oi(t,e)}(e,ei),e}();function ai(t){return(ai="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ci(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ui(t,e){return!e||"object"!==ai(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function si(t){return(si=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function fi(t,e){return(fi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var hi=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ui(this,si(e).call(this,"paintformat"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&fi(t,e)}(e,Vn),n=e,(r=[{key:"setState",value:function(){}}])&&ci(n.prototype,r),i&&ci(n,i),e}();function pi(t){return(pi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function di(t,e){return!e||"object"!==pi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function vi(t){return(vi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function bi(t,e){return(bi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var gi=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),di(this,vi(e).call(this,"color",void 0,t))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&bi(t,e)}(e,un),n=e,(r=[{key:"dropdown",value:function(){var t=this.tag,e=this.value;return new Er(t,e)}}])&&yi(n.prototype,r),i&&yi(n,i),e}();function mi(t){return(mi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ki(t,e){return!e||"object"!==mi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Oi(t){return(Oi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Si(t,e){return(Si=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var xi=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ki(this,Oi(e).call(this,"bgcolor",void 0,t))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Si(t,e)}(e,un),n=e,(r=[{key:"dropdown",value:function(){var t=this.tag,e=this.value;return new Er(t,e)}}])&&wi(n.prototype,r),i&&wi(n,i),e}();function Ei(t){return(Ei="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ji(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function _i(t,e){return!e||"object"!==Ei(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ci(t){return(Ci=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ti(t,e){return(Ti=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Pi=function(t){function e(){var t,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=he.map(function(t){return l("div","".concat(bt,"-item")).on("click",function(){n.setTitle("".concat(t.pt)),n.change(t)}).child("".concat(t.pt))});return n=_i(this,(t=Ci(e)).call.apply(t,[this,"10","60px",!0,"bottom-left"].concat(ji(r))))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ti(t,e)}(e,dn),e}();function Ai(t){return(Ai="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ri(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Di(t,e){return!e||"object"!==Ai(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zi(t){return(zi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ii(t,e){return(Ii=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Wi=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Di(this,zi(e).call(this,"font-size"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ii(t,e)}(e,un),n=e,(r=[{key:"getValue",value:function(t){return t.pt}},{key:"dropdown",value:function(){return new Pi}}])&&Ri(n.prototype,r),i&&Ri(n,i),e}();function Mi(t){return(Mi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fi(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Ni(t,e){return!e||"object"!==Mi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Hi(t){return(Hi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Vi(t,e){return(Vi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Li=function(t){function e(){var t,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=fe.map(function(t){return l("div","".concat(bt,"-item")).on("click",function(){n.setTitle(t.title),n.change(t)}).child(t.title)});return n=Ni(this,(t=Hi(e)).call.apply(t,[this,fe[0].title,"160px",!0,"bottom-left"].concat(Fi(r))))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Vi(t,e)}(e,dn),e}();function qi(t){return(qi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ui(t,e){return!e||"object"!==qi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Yi(t){return(Yi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $i(t,e){return($i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xi=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ui(this,Yi(e).call(this,"font-name"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$i(t,e)}(e,un),n=e,(r=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new Li}}])&&Bi(n.prototype,r),i&&Bi(n,i),e}();function Ki(t){return(Ki="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ji(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Zi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Gi(t,e){return!e||"object"!==Ki(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Qi(t){return(Qi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function to(t,e){return(to=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var eo=function(t){function e(){var t,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=Ce.slice(0);return r.splice(2,0,{key:"divider"}),r.splice(8,0,{key:"divider"}),r=r.map(function(t){var e=l("div","".concat(bt,"-item"));return"divider"===t.key?e.addClass("divider"):(e.child(t.title()).on("click",function(){n.setTitle(t.title()),n.change(t)}),t.label&&e.child(l("div","label").html(t.label))),e}),n=Gi(this,(t=Qi(e)).call.apply(t,[this,"Normal","220px",!0,"bottom-left"].concat(Ji(r))))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&to(t,e)}(e,dn),n=e,(r=[{key:"setTitle",value:function(t){for(var e=0;e<Ce.length;e+=1)Ce[e].key===t&&this.title.html(Ce[e].title);this.hide()}}])&&Zi(n.prototype,r),i&&Zi(n,i),e}();function no(t){return(no="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ro(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function io(t,e){return!e||"object"!==no(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function oo(t){return(oo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function lo(t,e){return(lo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ao=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),io(this,oo(e).call(this,"format"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&lo(t,e)}(e,un),n=e,(r=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new eo}}])&&ro(n.prototype,r),i&&ro(n,i),e}();function co(t){return(co="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function uo(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function so(t,e){return!e||"object"!==co(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function fo(t){return(fo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ho(t,e){return(ho=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var po=function(t){function e(){var t,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=we.map(function(t){return l("div","".concat(bt,"-item")).on("click",function(){n.hide(),console.log(t),n.change(t)}).child(t.key)});return n=so(this,(t=fo(e)).call.apply(t,[this,new Xt("formula"),"180px",!0,"bottom-right"].concat(uo(r))))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ho(t,e)}(e,dn),e}();function yo(t){return(yo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function bo(t,e){return!e||"object"!==yo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function go(t){return(go=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function mo(t,e){return(mo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var wo=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),bo(this,go(e).call(this,"formula"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&mo(t,e)}(e,un),n=e,(r=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new po}}])&&vo(n.prototype,r),i&&vo(n,i),e}();function ko(t){return(ko="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Oo(t,e){return!e||"object"!==ko(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function So(t){return(So=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xo(t,e){return(xo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Eo=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Oo(this,So(e).call(this,"freeze"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xo(t,e)}(e,Vn),e}();function jo(t){return(jo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Co(t,e){return!e||"object"!==jo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function To(t){return(To=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Po(t,e){return(Po=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ao=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Co(this,To(e).call(this,"merge"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Po(t,e)}(e,Vn),n=e,(r=[{key:"setState",value:function(t,e){this.el.active(t).disabled(e)}}])&&_o(n.prototype,r),i&&_o(n,i),e}();function Ro(t){return(Ro="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Do(t,e){return!e||"object"!==Ro(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zo(t){return(zo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Io(t,e){return(Io=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Wo=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Do(this,zo(e).call(this,"redo","Ctrl+Y"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Io(t,e)}(e,ei),e}();function Mo(t){return(Mo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fo(t,e){return!e||"object"!==Mo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function No(t){return(No=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ho(t,e){return(Ho=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Vo=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Fo(this,No(e).call(this,"undo","Ctrl+Z"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ho(t,e)}(e,ei),e}();function Lo(t){return(Lo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qo(t,e){return!e||"object"!==Lo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Bo(t){return(Bo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Uo(t,e){return(Uo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Yo=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),qo(this,Bo(e).call(this,"print","Ctrl+P"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Uo(t,e)}(e,ei),e}();function $o(t){return($o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ko(t,e){return!e||"object"!==$o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Jo(t){return(Jo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Zo(t,e){return(Zo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Go=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Ko(this,Jo(e).call(this,"input"))).tableData=t,n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zo(t,e)}(e,en),n=e,(r=[{key:"element",value:function(){var t=this,e=this.tag;return this.vchange=function(){t.value=t.input.el.value,t.change(e,t.input.el.value)},this.enter=function(t){13===(t.keyCode||t.which)&&t.target.blur()},this.el=l("div","".concat(bt,"-toolbar-btn")),this.input=l("input","").css("width","400px").on("input",function(e){return t.vchange(e)}).on("keydown",function(e){return t.enter(e)}).attr("placeholder",""),this.el.child(this.input),this.el}},{key:"setState",value:function(t){t?(this.input.el.value=t,this.value=t):(this.input.el.value="",this.value="")}}])&&Xo(n.prototype,r),i&&Xo(n,i),e}();function Qo(t){return(Qo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tl(t,e){return!e||"object"!==Qo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function el(t){return(el=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function nl(t,e){return(nl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var rl=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),tl(this,el(e).call(this,"textwrap"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&nl(t,e)}(e,Vn),e}();function il(t){return(il="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ol(t,e){return!e||"object"!==il(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ll(t){return(ll=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function al(t,e){return(al=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var cl=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=new Xt("ellipsis"),r=l("div","".concat(bt,"-toolbar-more"));return(t=ol(this,ll(e).call(this,n,"auto",!1,"bottom-right",r))).moreBtns=r,t.contentEl.css("max-width","420px"),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&al(t,e)}(e,dn),e}();function ul(t){return(ul="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function fl(t,e){return!e||"object"!==ul(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function hl(t){return(hl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function pl(t,e){return(pl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var yl=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=fl(this,hl(e).call(this,"more"))).el.show(),t}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pl(t,e)}(e,un),n=e,(r=[{key:"dropdown",value:function(){return new cl}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide()}}])&&sl(n.prototype,r),i&&sl(n,i),e}();function dl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function vl(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var l,a=t[Symbol.iterator]();!(r=(l=a.next()).done)&&(n.push(l.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function bl(){return l("div","".concat(bt,"-toolbar-divider"))}function gl(){var t,e,n=this.el,r=this.btns,i=this.moreEl,o=this.btns2,l=i.dd,a=l.moreBtns,c=l.contentEl;n.css("width","".concat(this.widthFn()-60,"px"));var u=n.box(),s=160,f=12,h=[],p=[];o.forEach(function(t,e){var n=vl(t,2),r=n[0],i=n[1];s+=i,e===o.length-1||s<u.width?h.push(r):(f+=i,p.push(r))}),(t=r.html("")).children.apply(t,h),(e=a.html("")).children.apply(e,p),c.css("width","".concat(f,"px")),p.length>0?i.show():i.hide()}var ml=function(){function t(e,n){var r=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.data=e,this.change=function(){},this.widthFn=n,this.isHide=i;var o=e.defaultStyle();this.items=[[this.undoEl=new Vo,this.redoEl=new Wo,this.paintformatEl=new hi,this.clearformatEl=new li],bl(),[this.formatEl=new ao],bl(),[this.fontEl=new Xi,this.fontSizeEl=new Wi],bl(),[this.boldEl=new Gn,this.italicEl=new rr,this.underlineEl=new pr,this.strikeEl=new cr,this.textColorEl=new gi(o.color)],bl(),[this.fillColorEl=new xi(o.bgcolor),this.borderEl=new Xr,this.mergeEl=new Ao],bl(),[this.alignEl=new Cn(o.align),this.valignEl=new zn(o.valign),this.textwrapEl=new rl],bl(),[this.freezeEl=new Eo,this.autofilterEl=new $n,this.formulaEl=new wo,this.moreEl=new yl],bl(),[this.printEL=new Yo,this.inputEL=new Go(e)]],this.el=l("div","".concat(bt,"-toolbar")),this.btns=l("div","".concat(bt,"-toolbar-btns")),this.items.forEach(function(t){Array.isArray(t)?t.forEach(function(t){r.btns.child(t.el),t.change=function(){r.change.apply(r,arguments)}}):r.btns.child(t.el)}),this.el.child(this.btns),i?this.el.hide():(this.reset(),setTimeout(function(){(function(){var t=this;this.btns2=[],this.items.forEach(function(e){if(Array.isArray(e))e.forEach(function(e){var n=e.el,r=n.box(),i=n.computedStyle(),o=i.marginLeft,l=i.marginRight;t.btns2.push([n,r.width+parseInt(o,10)+parseInt(l,10)])});else{var n=e.box(),r=e.computedStyle(),i=r.marginLeft,o=r.marginRight;t.btns2.push([e,n.width+parseInt(i,10)+parseInt(o,10)])}})}).call(r),gl.call(r)},0),ft(window,"resize",function(){gl.call(r)}))}var e,n,r;return e=t,(n=[{key:"paintformatActive",value:function(){return this.paintformatEl.active()}},{key:"paintformatToggle",value:function(){this.paintformatEl.toggle()}},{key:"trigger",value:function(t){this["".concat(t,"El")].click()}},{key:"reset",value:function(){if(!this.isHide){var t=this.data,e=t.getSelectedCellStyle(),n=t.getSelectedCell();this.undoEl.setState(!t.canUndo()),this.redoEl.setState(!t.canRedo()),this.mergeEl.setState(t.canUnmerge(),!t.selector.multiple()),this.autofilterEl.setState(!t.canAutofilter());var r=e.font;this.fontEl.setState(r.name),this.fontSizeEl.setState(r.size),this.boldEl.setState(r.bold),this.italicEl.setState(r.italic),this.underlineEl.setState(e.underline),this.strikeEl.setState(e.strike),this.textColorEl.setState(e.color),this.fillColorEl.setState(e.bgcolor),this.alignEl.setState(e.align),this.valignEl.setState(e.valign),this.textwrapEl.setState(e.textwrap),this.freezeEl.setState(t.freezeIsActive()),n&&n.format&&this.formatEl.setState(n.format)}}}])&&dl(e.prototype,n),r&&dl(e,r),t}();function wl(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function kl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ol=function(){function t(e,n){var r,i=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"600px";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.title=e,this.el=l("div","".concat(bt,"-modal")).css("width",o).children(l("div","".concat(bt,"-modal-header")).children(new Xt("close").on("click.stop",function(){return i.hide()}),this.title),(r=l("div","".concat(bt,"-modal-content"))).children.apply(r,wl(n))).hide()}var e,n,r;return e=t,(n=[{key:"show",value:function(){var t=this;this.dimmer=l("div","".concat(bt,"-dimmer active")),document.body.appendChild(this.dimmer.el);var e=this.el.show().box(),n=e.width,r=e.height,i=document.documentElement,o=i.clientHeight,a=i.clientWidth;this.el.offset({left:(a-n)/2,top:(o-r)/3}),window.xkeydownEsc=function(e){27===e.keyCode&&t.hide()},ft(window,"keydown",window.xkeydownEsc)}},{key:"hide",value:function(){this.el.hide(),document.body.removeChild(this.dimmer.el),ht(window,"keydown",window.xkeydownEsc),delete window.xkeydownEsc}}])&&kl(e.prototype,n),r&&kl(e,r),t}();function Sl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var xl=function(){function t(e,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.vchange=function(){},this.el=l("div","".concat(bt,"-form-input")),this.input=l("input","").css("width",e).on("input",function(t){return r.vchange(t)}).attr("placeholder",n),this.el.child(this.input)}var e,n,r;return e=t,(n=[{key:"hint",value:function(t){this.input.attr("placeholder",t)}},{key:"val",value:function(t){return this.input.val(t)}}])&&Sl(e.prototype,n),r&&Sl(e,r),t}();function El(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var jl=function(){function t(e,n,r){var i=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(t){return t},a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.key=e,this.getTitle=o,this.vchange=function(){},this.el=l("div","".concat(bt,"-form-select")),this.suggest=new Lt(n.map(function(t){return{key:t,title:i.getTitle(t)}}),function(t){i.itemClick(t.key),a(t.key),i.vchange(t.key)},r,this.el),this.el.children(this.itemEl=l("div","input-text").html(this.getTitle(e)),this.suggest.el).on("click",function(){return i.show()})}var e,n,r;return e=t,(n=[{key:"show",value:function(){this.suggest.search("")}},{key:"itemClick",value:function(t){this.key=t,this.itemEl.html(this.getTitle(t))}},{key:"val",value:function(t){return void 0!==t?(this.key=t,this.itemEl.html(this.getTitle(t)),this):this.key}}])&&El(e.prototype,n),r&&El(e,r),t}();function _l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Cl={number:/(^\d+$)|(^\d+(\.\d{0,4})?$)/,date:/^\d{4}-\d{1,2}-\d{1,2}$/},Tl=function(){function t(e,n,r,i){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.label="",this.rule=n,r&&(this.label=l("label","label").css("width","".concat(i,"px")).html(r)),this.tip=l("div","tip").child("tip").hide(),this.input=e,this.input.vchange=function(){return o.validate()},this.el=l("div","".concat(bt,"-form-field")).children(this.label,e.el,this.tip)}var e,n,r;return e=t,(n=[{key:"isShow",value:function(){return"none"!==this.el.css("display")}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"val",value:function(t){return this.input.val(t)}},{key:"hint",value:function(t){this.input.hint(t)}},{key:"validate",value:function(){var t=this.input,e=this.rule,n=this.tip,r=this.el,i=t.val();if(e.required&&/^\s*$/.test(i))return n.html(L("validation.required")),r.addClass("error"),!1;if((e.type||e.pattern)&&!(e.pattern||Cl[e.type]).test(i))return n.html(L("validation.notMatch")),r.addClass("error"),!1;return r.removeClass("error"),!0}}])&&_l(e.prototype,n),r&&_l(e,r),t}();function Pl(t){return(Pl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Al(t,e){return!e||"object"!==Pl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Rl(t){return(Rl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Dl(t,e){return(Dl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var zl=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Al(this,Rl(e).call(this,"div","".concat(bt,"-button ").concat(r)))).child(L("button.".concat(t))),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Dl(t,e)}(e,o),e}();function Il(t){return(Il="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ml(t,e){return!e||"object"!==Il(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Fl(t){return(Fl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Nl(t,e){return(Nl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Hl=100,Vl=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=new Tl(new jl("cell",["cell"],"100%",function(t){return L("dataValidation.modeType.".concat(t))}),{required:!0},"".concat(L("dataValidation.range"),":"),Hl),r=new Tl(new xl("120px","E3 or E3:F12"),{required:!0,pattern:/^([A-Z]{1,2}[1-9]\d*)(:[A-Z]{1,2}[1-9]\d*)?$/}),i=new Tl(new jl("list",["list","number","date","phone","email"],"100%",function(t){return L("dataValidation.type.".concat(t))},function(e){return t.criteriaSelected(e)}),{required:!0},"".concat(L("dataValidation.criteria"),":"),Hl),o=new Tl(new jl("be",["be","nbe","eq","neq","lt","lte","gt","gte"],"160px",function(t){return L("dataValidation.operator.".concat(t))},function(e){return t.criteriaOperatorSelected(e)}),{required:!0}).hide(),a=new Tl(new xl("70px","10"),{required:!0}).hide(),c=new Tl(new xl("70px","100"),{required:!0,type:"number"}).hide(),u=new Tl(new xl("120px","a,b,c"),{required:!0}),s=new Tl(new xl("70px","10"),{required:!0,type:"number"}).hide();return(t=Ml(this,Fl(e).call(this,L("contextmenu.validation"),[l("div","".concat(bt,"-form-fields")).children(n.el,r.el),l("div","".concat(bt,"-form-fields")).children(i.el,o.el,a.el,c.el,s.el,u.el),l("div","".concat(bt,"-buttons")).children(new zl("cancel").on("click",function(){return t.btnClick("cancel")}),new zl("remove").on("click",function(){return t.btnClick("remove")}),new zl("save","primary").on("click",function(){return t.btnClick("save")}))]))).mf=n,t.rf=r,t.cf=i,t.of=o,t.minvf=a,t.maxvf=c,t.vf=s,t.svf=u,t.change=function(){},t}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Nl(t,e)}(e,Ol),n=e,(r=[{key:"showVf",value:function(t){var e="date"===t?"2018-11-12":"10",n=this.vf;n.input.hint(e),n.show()}},{key:"criteriaSelected",value:function(t){var e=this.of,n=this.minvf,r=this.maxvf,i=this.vf,o=this.svf;"date"===t||"number"===t?(e.show(),n.rule.type=t,r.rule.type=t,"date"===t?(n.hint("2018-11-12"),r.hint("2019-11-12")):(n.hint("10"),r.hint("100")),n.show(),r.show(),i.hide(),o.hide()):("list"===t?o.show():o.hide(),i.hide(),e.hide(),n.hide(),r.hide())}},{key:"criteriaOperatorSelected",value:function(t){if(t){var e=this.minvf,n=this.maxvf,r=this.vf;if("be"===t||"nbe"===t)e.show(),n.show(),r.hide();else{var i=this.cf.val();r.rule.type=i,"date"===i?r.hint("2018-11-12"):r.hint("10"),r.show(),e.hide(),n.hide()}}}},{key:"btnClick",value:function(t){if("cancel"===t)this.hide();else if("remove"===t)this.change("remove"),this.hide();else if("save"===t){for(var e=["mf","rf","cf","of","svf","vf","minvf","maxvf"],n=0;n<e.length;n+=1){var r=this[e[n]];if(r.isShow()&&!r.validate())return}var i=this.mf.val(),o=this.rf.val(),l=this.cf.val(),a=this.of.val(),c=this.svf.val();"number"!==l&&"date"!==l||(c="be"===a||"nbe"===a?[this.minvf.val(),this.maxvf.val()]:this.vf.val()),this.change("save",i,o,{type:l,operator:a,required:!1,value:c}),this.hide()}}},{key:"setValue",value:function(t){if(t){var e=this.mf,n=this.rf,r=this.cf,i=this.of,o=this.svf,l=this.vf,a=this.minvf,c=this.maxvf,u=t.mode,s=t.ref,f=t.validator||{type:"list"},h=f.type,p=f.operator,y=f.value;e.val(u||"cell"),n.val(s),r.val(h),i.val(p),Array.isArray(y)?(a.val(y[0]),c.val(y[1])):(o.val(y||""),l.val(y||"")),this.criteriaSelected(h),this.criteriaOperatorSelected(p)}this.show()}}])&&Wl(n.prototype,r),i&&Wl(n,i),e}();function Ll(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ql(t){return l("div","".concat(bt,"-item ").concat(t))}function Bl(t){var e=this;return ql("state").child(L("sort.".concat(t))).on("click.stop",function(){return e.itemClick(t)})}function Ul(){var t=this.filterhEl,e=this.filterValues,n=this.values;t.html("".concat(e.length," / ").concat(n.length)),t.checked(e.length===n.length)}var Yl=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.filterbEl=l("div","".concat(bt,"-body")),this.filterhEl=l("div","".concat(bt,"-header state")).on("click.stop",function(){return e.filterClick(0,"all")}),this.el=l("div","".concat(bt,"-sort-filter")).children(this.sortAscEl=Bl.call(this,"asc"),this.sortDescEl=Bl.call(this,"desc"),ql("divider"),l("div","".concat(bt,"-filter")).children(this.filterhEl,this.filterbEl),l("div","".concat(bt,"-buttons")).children(new zl("cancel").on("click",function(){return e.btnClick("cancel")}),new zl("ok","primary").on("click",function(){return e.btnClick("ok")}))).hide(),this.ci=null,this.sortDesc=null,this.values=null,this.filterValues=[]}var e,n,r;return e=t,(n=[{key:"btnClick",value:function(t){if("ok"===t){var e=this.ci,n=this.sort,r=this.filterValues;this.ok&&this.ok(e,n,"in",r)}this.hide()}},{key:"itemClick",value:function(t){this.sort=t;var e=this.sortAscEl,n=this.sortDescEl;e.checked("asc"===t),n.checked("desc"===t)}},{key:"filterClick",value:function(t,e){var n=this.filterbEl,r=this.filterValues,i=this.values,o=n.children();"all"===e?o.length===r.length?(this.filterValues=[],o.forEach(function(t){return l(t).checked(!1)})):(this.filterValues=Array.from(i),o.forEach(function(t){return l(t).checked(!0)})):l(o[t]).toggle("checked")?r.push(e):r.splice(r.findIndex(function(t){return t===e}),1);Ul.call(this)}},{key:"set",value:function(t,e,n,r){this.ci=t;var i=this.sortAscEl,o=this.sortDescEl;null!==r?(this.sort=r.order,i.checked(r.asc()),o.checked(r.desc())):(this.sortDesc=null,i.checked(!1),o.checked(!1)),this.values=Object.keys(e),this.filterValues=n?Array.from(n.value):Object.keys(e),function(t){var e=this,n=this.filterbEl,r=this.filterValues;n.html(""),Object.keys(t).forEach(function(i,o){var a=t[i],c=r.includes(i)?"checked":"";n.child(l("div","".concat(bt,"-item state ").concat(c)).on("click.stop",function(){return e.filterClick(o,i)}).children(""===i?L("filter.empty"):i,l("div","label").html("(".concat(a,")"))))})}.call(this,e,n),Ul.call(this)}},{key:"setOffset",value:function(t){var e=this;this.el.offset(t).show();var n=1;yt(this.el,function(){n<=0&&e.hide(),n-=1})}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide(),pt(this.el)}}])&&Ll(e.prototype,n),r&&Ll(e,r),t}();function $l(t,e){var n=l("div","".concat(bt,"-toast")),r=l("div","".concat(bt,"-dimmer active"));n.children(l("div","".concat(bt,"-toast-header")).children(new Xt("close").on("click.stop",function(){return document.body.removeChild(n.el),void document.body.removeChild(r.el)}),t),l("div","".concat(bt,"-toast-content")).html(e)),document.body.appendChild(n.el),document.body.appendChild(r.el);var i=n.box(),o=i.width,a=i.height,c=document.documentElement,u=c.clientHeight,s=c.clientWidth;n.offset({left:(s-o)/2,top:(u-a)/3})}function Xl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Kl(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var l,a=t[Symbol.iterator]();!(r=(l=a.next()).done)&&(n.push(l.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Jl(t,e,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(-1!==e||-1!==n){var o=this.table,l=this.selector,a=this.toolbar;if(t)l.setEnd(e,n,i);else{l.set(e,n,r);var c=this.data.getCellTextOrDefault(e,n);this.toolbar.inputEL.setState(c)}a.reset(),o.render()}}function Zl(t,e){var n=this.selector,r=this.data,i=r.rows,o=r.cols,l=Kl(n.indexes,2),a=l[0],c=l[1],u=n.range,s=u.eri,f=u.eci;if(t){var h=Kl(n.moveIndexes,2);a=h[0],c=h[1]}"left"===e?c>0&&(c-=1):"right"===e?(f!==c&&(c=f),c<o.len-1&&(c+=1)):"up"===e?a>0&&(a-=1):"down"===e?(s!==a&&(a=s),a<i.len-1&&(a+=1)):"row-first"===e?c=0:"row-last"===e?c=o.len-1:"col-first"===e?a=0:"col-last"===e&&(a=i.len-1),t&&(n.moveIndexes=[a,c]),Jl.call(this,t,a,c),function(){var t=this.data,e=this.verticalScrollbar,n=this.horizontalScrollbar,r=t.getSelectedRect(),i=r.l,o=r.t,l=r.left,a=r.top,c=r.width,u=r.height,s=this.getTableOffset();if(Math.abs(l)+c>s.width)n.move({left:i+c-s.width});else{var f=t.freezeTotalWidth();l<f&&n.move({left:i-1-f})}if(Math.abs(a)+u>s.height)e.move({top:o+u-s.height-1});else{var h=t.freezeTotalHeight();a<h&&e.move({top:o-1-h})}}.call(this)}function Gl(){var t=this.data,e=this.verticalScrollbar,n=this.getTableOffset().height,r=t.exceptRowTotalHeight(0,-1);e.set(n,t.rows.totalHeight()-r)}function Ql(){var t=this.data,e=this.horizontalScrollbar,n=this.getTableOffset().width;t&&e.set(n,t.cols.totalWidth())}function ta(){var t=this.tableEl,e=this.overlayerEl,n=this.overlayerCEl,r=this.table,i=this.toolbar,o=this.selector,l=this.el,a=this.getTableOffset(),c=this.getRect();t.attr(c),e.offset(c),n.offset(a),l.css("width","".concat(c.width,"px")),Gl.call(this),Ql.call(this),function(){var t=this.selector,e=this.data,n=this.editor,r=Kl(e.freeze,2),i=r[0],o=r[1];if(i>0||o>0){var l=e.freezeTotalWidth(),a=e.freezeTotalHeight();n.setFreezeLengths(l,a)}t.resetAreaOffset()}.call(this),r.render(),i.reset(),o.reset()}function ea(){var t=this.data,e=this.selector;t.clearClipboard(),e.hideClipboard()}function na(){var t=this.data,e=this.selector;t.copy(),e.showClipboard()}function ra(){var t=this.data,e=this.selector;t.cut(),e.showClipboard()}function ia(t){this.data.paste(t,function(t){return $l("Tip",t)})&&ta.call(this)}function oa(t){var e=this,n=this.selector,r=this.data,i=this.table,o=this.sortFilter,l=t.offsetX,a=t.offsetY,c=t.target.className==="".concat(bt,"-selector-corner"),u=r.getCellRectByXY(l,a),s=u.left,f=u.top,h=u.width,p=u.height,y=u.ri,d=u.ci,v=r.autoFilter;if(v.includes(y,d)&&s+h-20<l&&f+p-20<a){var b=v.items(d,function(t,e){return r.rows.getCell(t,e)});return o.set(d,b,v.getFilter(d),v.getSort(d)),void o.setOffset({left:s,top:f+p+2})}t.shiftKey||(c?n.showAutofill(y,d):Jl.call(this,!1,y,d),dt(window,function(t){var i=r.getCellRectByXY(t.offsetX,t.offsetY);y=i.ri,d=i.ci,c?n.showAutofill(y,d):1!==t.buttons||t.shiftKey||Jl.call(e,!0,y,d,!0,!0)},function(){c&&r.autofill(n.arange,"all",function(t){return $l("Tip",t)})&&i.render(),n.hideAutofill(),function(){var t=this.toolbar;t.paintformatActive()&&(ia.call(this,"format"),ea.call(this),t.paintformatToggle())}.call(e)})),c||1!==t.buttons||t.shiftKey&&Jl.call(this,!0,y,d)}function la(){var t=this.editor,e=this.data.getSelectedRect(),n=this.getTableOffset(),r="top";e.top>n.height/2&&(r="bottom"),t.setOffset(e,r)}function aa(){var t=this.editor,e=this.data;la.call(this),t.setCell(e.getSelectedCell(),e.getSelectedValidator()),ea.call(this)}function ca(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"finished",n=this.data,r=this.table;n.setSelectedCellText(t,e),"finished"===e&&r.render()}function ua(t){var e=this,n=this.data;if("insert-row"===t)n.insert("row");else if("delete-row"===t)n.delete("row");else if("insert-column"===t)n.insert("column");else if("delete-column"===t)n.delete("column");else if("delete-cell"===t)n.deleteCell();else if("delete-cell-format"===t)n.deleteCell("format");else if("delete-cell-text"===t)n.deleteCell("text");else if("cell-printable"===t){var r=this.selector.range;this.data.changeData(function(){r.each(function(t,n){if(null!==e.data.rows.get(t)){var r=e.data.rows.getCell(t,n);console.log("CELL",r),null!==r&&(r.printable=!0)}})})}else if("cell-non-printable"===t){var i=this.selector.range;this.data.changeData(function(){i.each(function(t,n){if(null!==e.data.rows.get(t)){var r=e.data.rows.getCell(t,n);console.log("CELL",r),null!==r&&(r.printable=!1)}})})}else if("cell-editable"===t){var o=this.selector.range;this.data.changeData(function(){o.each(function(t,n){if(null!==e.data.rows.get(t)){var r=e.data.rows.getCell(t,n);console.log("CELL",r),null!==r&&(r.editable=!0)}})})}else if("cell-non-editable"===t){var l=this.selector.range;this.data.changeData(function(){l.each(function(t,n){if(null!==e.data.rows.get(t)){var r=e.data.rows.getCell(t,n);console.log("CELL",r),null!==r&&(r.editable=!1)}})})}ea.call(this),ta.call(this)}function sa(t,e){var n=this.data;if("undo"===t)this.undo();else if("redo"===t)this.redo();else if("print"===t)this.print();else if("input"===t)this.input(e);else if("paintformat"===t)!0===e?na.call(this):ea.call(this);else if("clearformat"===t)ua.call(this,"delete-cell-format");else if("link"===t);else if("chart"===t);else if("autofilter"===t)(function(){this.data.autofilter(),ta.call(this)}).call(this);else if("freeze"===t)if(e){var r=n.selector,i=r.ri,o=r.ci;this.freeze(i,o)}else this.freeze(0,0);else n.setSelectedCellAttr(t,e),"formula"!==t||n.selector.multiple()||(this.toolbar.inputEL.setState("="+e+"()"),aa.call(this)),ta.call(this)}function fa(){var t,e,n,r,i,o,l=this,a=this.overlayerEl,c=this.rowResizer,u=this.colResizer,s=this.verticalScrollbar,f=this.horizontalScrollbar,h=this.editor,p=this.contextMenu,y=this.data,d=this.toolbar,v=this.modalValidation,b=this.sortFilter;a.on("mousemove",function(t){(function(t){if(0===t.buttons&&t.target.className!=="".concat(bt,"-resizer-hover")){var e=t.offsetX,n=t.offsetY,r=this.rowResizer,i=this.colResizer,o=this.tableEl,l=this.data,a=l.rows,c=l.cols;e>c.indexWidth&&n>a.height&&(r.hide(),i.hide());var u=o.box(),s=l.getCellRectByXY(t.offsetX,t.offsetY);if(this.data.getCell(s.ri,s.ci)){this.commemtEL.html(this.data.getCellTextOrDefault(s.ri,s.ci));var f=this.data.cellRect(s.ri,s.ci),h=f.left,p=f.top,y=f.width,d=f.height;this.commemtEL.css("left","".concat(h+y/2,"px")).css("top","".concat(p+2*d,"px")),this.commemtEL.show()}else this.commemtEL.hide();0==s.ri&&s.ci,s.ri>=0&&-1===s.ci?(s.width=c.indexWidth,r.show(s,{width:u.width})):r.hide(),-1===s.ri&&s.ci>=0?(s.height=a.height,i.show(s,{height:u.height})):i.hide()}}).call(l,t)}).on("mousedown",function(t){2===t.buttons?y.xyInSelectedRect(t.offsetX,t.offsetY)?(p.setPosition(t.offsetX,t.offsetY),t.stopPropagation()):p.hide():2===t.detail?aa.call(l):(h.clear(),oa.call(l,t))}).on("mousewheel.stop",function(t){(function(t){var e=this.verticalScrollbar,n=this.horizontalScrollbar,r=this.data,i=e.scroll().top,o=n.scroll().left,l=r.rows,a=r.cols,c=t.deltaY;if(t.detail&&(c=40*t.detail),c>0){var u=r.scroll.ri+1;u<l.len&&e.move({top:i+l.getHeight(u)-1})}else{var s=r.scroll.ri-1;s>=0&&e.move({top:0===s?0:i-l.getHeight(s)})}if(t.deltaX>0){var f=r.scroll.ci+1;f<a.len&&n.move({left:o+a.getWidth(f)-1})}else{var h=r.scroll.ci-1;h>=0&&n.move({left:0===h?0:o-a.getWidth(h)})}}).call(l,t)}),t=a.el,n=(e={move:function(t,e){(function(t,e){var n=this.verticalScrollbar,r=this.horizontalScrollbar,i=n.scroll().top,o=r.scroll().left;"left"===t||"right"===t?r.move({left:o-e}):"up"!==t&&"down"!==t||n.move({top:i-e})}).call(l,t,e)}}).move,r=e.end,i=0,o=0,ft(t,"touchstart",function(t){var e=t.touches[0],n=e.pageX,r=e.pageY;i=n,o=r}),ft(t,"touchmove",function(t){if(n){var e=t.changedTouches[0],r=e.pageX,l=e.pageY,a=r-i,c=l-o;(Math.abs(a)>10||Math.abs(c)>10)&&(vt(a,c,t,n),i=r,o=l),t.preventDefault()}}),ft(t,"touchend",function(t){if(r){var e=t.changedTouches[0],n=e.pageX,l=e.pageY;vt(n-i,l-o,t,r)}}),d.change=function(t,e){return sa.call(l,t,e)},b.ok=function(t,e,n,r){return function(t,e,n,r){this.data.setAutoFilter(t,e,n,r),ta.call(this)}.call(l,t,e,n,r)},c.finishedFn=function(t,e){(function(t,e){var n=t.ri,r=this.table,i=this.selector;this.data.rows.setHeight(n,e),r.render(),i.resetAreaOffset(),Gl.call(this),la.call(this)}).call(l,t,e)},u.finishedFn=function(t,e){(function(t,e){var n=t.ci,r=this.table,i=this.selector;this.data.cols.setWidth(n,e),r.render(),i.resetAreaOffset(),Ql.call(this),la.call(this)}).call(l,t,e)},s.moveFn=function(t,e){(function(t){var e=this,n=this.data,r=this.table,i=this.selector;n.scrolly(t,function(){i.resetBRLAreaOffset(),la.call(e),r.render()})}).call(l,t,e)},f.moveFn=function(t,e){(function(t){var e=this,n=this.data,r=this.table,i=this.selector;n.scrollx(t,function(){i.resetBRTAreaOffset(),la.call(e),r.render()})}).call(l,t,e)},h.change=function(t,e){ca.call(l,e,t),l.toolbar.inputEL.setState(e)},v.change=function(t){if("save"===t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];y.addValidation.apply(y,n)}else y.removeValidation()},p.itemClick=function(t){"validation"===t?v.setValue(y.getSelectedValidation()):"copy"===t?na.call(l):"cut"===t?ra.call(l):"paste"===t?ia.call(l,"all"):"paste-value"===t?ia.call(l,"text"):"paste-format"===t?ia.call(l,"format"):ua.call(l,t)},ft(window,"resize",function(){l.reload()}),ft(window,"click",function(t){l.focusing=a.contains(t.target)}),ft(window,"keydown",function(t){if(l.focusing){var e=t.keyCode||t.which,n=t.key,r=t.ctrlKey,i=t.shiftKey,o=t.altKey,a=t.metaKey;if(r||a){var c="all";switch(i&&(c="text"),o&&(c="format"),e){case 90:l.undo(),t.preventDefault();break;case 89:l.redo(),t.preventDefault();break;case 67:na.call(l),t.preventDefault();break;case 88:ra.call(l),t.preventDefault();break;case 85:d.trigger("underline"),t.preventDefault();break;case 86:ia.call(l,c),t.preventDefault();break;case 37:Zl.call(l,i,"row-first"),t.preventDefault();break;case 38:Zl.call(l,i,"col-first"),t.preventDefault();break;case 39:Zl.call(l,i,"row-last"),t.preventDefault();break;case 40:Zl.call(l,i,"col-last"),t.preventDefault();break;case 32:Jl.call(l,!1,-1,y.selector.ci,!1),t.preventDefault();break;case 66:d.trigger("bold");break;case 73:d.trigger("italic")}}else{switch(e){case 32:i&&Jl.call(l,!1,y.selector.ri,-1,!1);break;case 27:p.hide(),ea.call(l);break;case 37:Zl.call(l,i,"left"),t.preventDefault();break;case 38:Zl.call(l,i,"up"),t.preventDefault();break;case 39:Zl.call(l,i,"right"),t.preventDefault();break;case 40:Zl.call(l,i,"down"),t.preventDefault();break;case 9:h.clear(),Zl.call(l,!1,i?"left":"right"),t.preventDefault();break;case 13:h.clear(),Zl.call(l,!1,i?"up":"down"),t.preventDefault();break;case 8:ua.call(l,"delete-cell-text"),t.preventDefault()}"Delete"===n?(ua.call(l,"delete-cell-text"),t.preventDefault()):e>=65&&e<=90||e>=48&&e<=57||e>=96&&e<=105||"="===t.key?(ca.call(l,t.key,"input"),aa.call(l)):113===e&&aa.call(l)}}})}var ha=function(){function t(e,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var i=n.settings,o=i.view,a=i.showToolbar,c=i.showContextmenu;this.el=l("div","".concat(bt,"-sheet")),this.toolbar=new ml(n,o.width,!a),e.children(this.toolbar.el,this.el),this.data=n,this.tableEl=l("canvas","".concat(bt,"-table")),this.rowResizer=new mt(!1,n.rows.height),this.colResizer=new mt(!0,n.cols.minWidth),this.verticalScrollbar=new kt(!0),this.horizontalScrollbar=new kt(!1),this.editor=new oe(ke,function(){return r.getTableOffset()},n.rows.height),this.modalValidation=new Vl,this.contextMenu=new se(function(){return r.getTableOffset()},!c),this.selector=new Ft(n),this.overlayerCEl=l("div","".concat(bt,"-overlayer-content")).children(this.editor.el,this.selector.el),this.commemtEL=l("div","x-spreadsheet-tooltip"),this.overlayerEl=l("div","".concat(bt,"-overlayer")).child(this.overlayerCEl),this.sortFilter=new Yl,this.el.children(this.tableEl,this.overlayerEl.el,this.rowResizer.el,this.colResizer.el,this.verticalScrollbar.el,this.horizontalScrollbar.el,this.contextMenu.el,this.modalValidation.el,this.sortFilter.el,this.commemtEL.el),this.table=new Qe(this.tableEl.el,n),fa.call(this),ta.call(this),Jl.call(this,!1,0,0)}var e,n,r;return e=t,(n=[{key:"loadData",value:function(t){return this.data.setData(t),ta.call(this),this}},{key:"freeze",value:function(t,e){return this.data.setFreeze(t,e),ta.call(this),this}},{key:"undo",value:function(){this.data.undo(),ta.call(this)}},{key:"redo",value:function(){this.data.redo(),ta.call(this)}},{key:"reload",value:function(){return ta.call(this),this}},{key:"print",value:function(){console.log("print start");var t={textAlign:"center",textBaseline:"middle",font:"500 ".concat(Me(12),"px Source Sans Pro"),fillStyle:"#585757",lineWidth:We(),strokeStyle:"#e6e6e6"};this.table.draw.attr(t),console.log("print end")}},{key:"input",value:function(t){var e=this.data,n=e.selector,r=n.ri,i=n.ci;e.setCellText(r,i,t),this.table.render()}},{key:"getRect",value:function(){var t=this.data;return{width:t.viewWidth(),height:t.viewHeight()}}},{key:"getTableOffset",value:function(){var t=this.data,e=t.rows,n=t.cols,r=this.getRect(),i=r.width,o=r.height;return{width:i-n.indexWidth,height:o-e.height,left:n.indexWidth,top:e.height}}}])&&Xl(e.prototype,n),r&&Xl(e,r),t}();n(1);function pa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n.d(e,"spreadsheet",function(){return da});var ya=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var r=e;"string"==typeof e&&(r=document.querySelector(e)),this.data=new st("sheet1",n);var i=l("div","".concat(bt)).on("contextmenu",function(t){return t.preventDefault()});r.appendChild(i.el),this.sheet=new ha(i,this.data)}var e,n,r;return e=t,r=[{key:"locale",value:function(t,e){B(t,e)}}],(n=[{key:"loadData",value:function(t){return this.sheet.loadData(t),this}},{key:"getData",value:function(){return this.data.getData()}},{key:"validate",value:function(){return this.data.validations.errors.size<=0}},{key:"change",value:function(t){return this.data.change=t,this}}])&&pa(e.prototype,n),r&&pa(e,r),t}(),da=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new ya(t,e)};window&&(window.x=window.x||{},window.x.spreadsheet=da,window.x.spreadsheet.locale=function(t,e){return B(t,e)});e.default=ya}]);
//# sourceMappingURL=xspreadsheet.js.map